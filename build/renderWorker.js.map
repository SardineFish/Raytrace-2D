{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/lib.ts","webpack:///./src/render.ts","webpack:///./src/renderWorker.ts","webpack:///./src/trace.ts"],"names":[],"mappings":"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","file":"renderWorker.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/renderWorker.ts\");\n","type SDFResult = [number, Material];\r\nexport type SDF = (x: number, y: number) => SDFResult;\r\n\r\nclass Color\r\n{\r\n    red: number = 255;\r\n    green: number = 255;\r\n    blue: number = 255;\r\n    alpha: number = 1.0;\r\n    constructor(r: number, g: number, b: number, a: number = 1.0)\r\n    {\r\n        this.red = r;\r\n        this.green = g;\r\n        this.blue = b;\r\n        this.alpha = a;\r\n    }\r\n\r\n    get hue(): number\r\n    {\r\n        const R = this.red / 255;\r\n        const G = this.green / 255;\r\n        const B = this.blue / 255;\r\n        const max = Math.max(R, G, B);\r\n        const min = Math.min(R, G, B);\r\n        let h;\r\n        if (max === min)\r\n            h = 0;\r\n        else if (max === R)\r\n            h = 60 * (0 + (G - B) / (max - min));\r\n        else if (max === G)\r\n            h = 60 * (2 + (B - R) / (max - min));\r\n        else if (max === B)\r\n            h = 60 * (4 + (R - G) / (max - min));\r\n        return h < 0 ? h + 360 : h;\r\n    }\r\n    get saturation(): number\r\n    {\r\n        const max = Math.max(this.red, this.green, this.blue) / 255;\r\n        const min = Math.min(this.red, this.blue, this.green) / 255;\r\n        if (max === 0)\r\n            return 0\r\n        else if (min == 1)\r\n            return 0;\r\n        return (max - min) / (1 - Math.abs(max + min - 1));\r\n    }\r\n    get lightness(): number\r\n    {\r\n        const max = Math.max(this.red, this.green, this.blue) / 255;\r\n        const min = Math.min(this.red, this.blue, this.green) / 255;\r\n        return (max + min) / 2;\r\n    }\r\n\r\n    set hue(value: number)\r\n    {\r\n        this.setHSL(value, this.saturation, this.lightness);\r\n    }\r\n    set saturation(value: number)\r\n    {\r\n        this.setHSL(this.hue, value, this.lightness);\r\n    }\r\n    set lightness(value: number)\r\n    {\r\n        this.setHSL(this.hue, this.saturation, value);\r\n    }\r\n\r\n    static add(a: Color, b: Color)\r\n    {\r\n        const t = b.alpha;\r\n        return new Color(\r\n            (1 - t) * a.red + t * b.red,\r\n            (1 - t) * a.green + t * b.green,\r\n            (1 - t) * a.blue + t * b.blue,\r\n            1 - (1 - a.alpha) * (1 - b.alpha)\r\n        );\r\n    }\r\n\r\n    static blend(a: Color, b: Color, t: number)\r\n    {\r\n        return new Color(\r\n            (1 - t) * a.red + t * b.red,\r\n            (1 - t) * a.green + t * b.green,\r\n            (1 - t) * a.blue + t * b.blue,\r\n            1\r\n        );\r\n    }\r\n\r\n    static fromHSL(h: number, s: number, l: number, alpha: number = 1)\r\n    {\r\n        return new Color(0, 0, 0, alpha).setHSL(h, s, l);\r\n    }\r\n\r\n    static from(color: Color)\r\n    {\r\n        return new Color(color.red, color.green, color.blue, color.alpha);\r\n    }\r\n\r\n    setHSL(h: number, s: number, l: number)\r\n    {\r\n        h = h < 0 ? h + 360 : h;\r\n        const chroma = (1 - Math.abs(2 * l - 1)) * s;\r\n        if (isNaN(h))\r\n        {\r\n            this.red = this.green = this.blue = 0;\r\n            return this;\r\n        }\r\n        h = h / 60;\r\n        const x = chroma * (1 - Math.abs(h % 2 - 1));\r\n        let color = [0, 0, 0];\r\n        if (0 <= h && h <= 1)\r\n            color = [chroma, x, 0];\r\n        else if (h <= 2)\r\n            color = [x, chroma, 0]\r\n        else if (h <= 3)\r\n            color = [0, chroma, x];\r\n        else if (h <= 4)\r\n            color = [0, x, chroma];\r\n        else if (h <= 5)\r\n            color = [x, 0, chroma];\r\n        else if (h <= 6)\r\n            color = [chroma, 0, x];\r\n        let m = l - chroma / 2;\r\n        this.red = Math.floor((color[0] + m) * 255);\r\n        this.green = Math.floor((color[1] + m) * 255);\r\n        this.blue = Math.floor((color[2] + m) * 255);\r\n        return this;\r\n    }\r\n\r\n    static fromString(str: string, alpha: number = 1): Color\r\n    {\r\n        str = str.replace(new RegExp(/\\s/g), \"\");\r\n\r\n        var reg = new RegExp(\"#[0-9a-fA-F]{6}\");\r\n        if (reg.test(str))\r\n        {\r\n            str = str.replace(\"#\", \"\");\r\n            var strR = str.charAt(0) + str.charAt(1);\r\n            var strG = str.charAt(2) + str.charAt(3);\r\n            var strB = str.charAt(4) + str.charAt(5);\r\n            var r = parseInt(strR, 16);\r\n            var g = parseInt(strG, 16);\r\n            var b = parseInt(strB, 16);\r\n            return new Color(r, g, b, alpha);\r\n        }\r\n        reg = new RegExp(\"rgb\\\\(([0-9]+(\\\\.[0-9]+){0,1}),([0-9]+(\\\\.[0-9]+){0,1}),([0-9]+(\\\\.[0-9]+){0,1})\\\\)\");\r\n        if (reg.test(str))\r\n        {\r\n            var colorArray = str.replace(\"rgb(\", \"\").replace(\")\", \"\").split(\",\");\r\n            var r = parseInt(colorArray[0]);\r\n            var g = parseInt(colorArray[1]);\r\n            var b = parseInt(colorArray[2]);\r\n            var a = 1.00;\r\n            return new Color(r, g, b, a);\r\n        }\r\n        reg = new RegExp(\"rgba\\\\(([0-9]+(\\\\.[0-9]+){0,1}),([0-9]+(\\\\.[0-9]+){0,1}),([0-9]+(\\\\.[0-9]+){0,1}),([0-9]+(\\\\.[0-9]+){0,1})\\\\)\");\r\n        if (reg.test(str))\r\n        {\r\n            var colorArray = str.replace(\"rgba(\", \"\").replace(\")\", \"\").split(\",\");\r\n            var r = parseInt(colorArray[0]);\r\n            var g = parseInt(colorArray[1]);\r\n            var b = parseInt(colorArray[2]);\r\n            var a = parseFloat(colorArray[3]);\r\n            return new Color(r, g, b, a);\r\n        }\r\n    }\r\n\r\n    toString()\r\n    {\r\n        return `rgba(${this.red},${this.green},${this.blue},${this.alpha})`;\r\n    }\r\n    toVector4(): Vector4\r\n    {\r\n        return new Vector4(this.red / 255, this.green / 255, this.blue / 255, this.alpha);\r\n    }\r\n}\r\nconst max = Math.max;\r\nconst min = Math.min;\r\nconst sqrt = Math.sqrt;\r\nconst abs = Math.abs;\r\nconst length = (x:number, y:number): number => sqrt(x * x + y * y);\r\nconst clamp = (n: number, min: number, max: number): number => n > max ? max : n < min ? min : n;\r\nconst smin = (a: number, b: number, k: number): number => -Math.log(Math.exp(-k * a) + Math.exp(-k * b)) / k;\r\n\r\nclass Vector2 extends Array<number>\r\n{\r\n    constructor(x: number|number[], y: number=0)\r\n    {\r\n        super(4);\r\n        if (x instanceof Array)\r\n        {\r\n            this[0] = x[0];\r\n            this[1] = x[1];\r\n        }\r\n        else\r\n        {\r\n            this[0] = x;\r\n            this[1] = y;\r\n        }\r\n    }\r\n    get x(): number\r\n    {\r\n        return this[0];\r\n    }\r\n    set x(value)\r\n    {\r\n        this[0] = value;\r\n    }\r\n    get y(): number\r\n    {\r\n        return this[1];\r\n    }\r\n    set y(value)\r\n    {\r\n        this[1] = value;\r\n    }\r\n    get normalized()\r\n    {\r\n        let l = Math.hypot(this.x, this.y);\r\n        return new Vector2(this.x / l, this.y / l);\r\n    }\r\n    get magnitude()\r\n    {\r\n        return Math.hypot(this[0], this[1]);\r\n    }\r\n}\r\n\r\nclass Vector4 extends Array<number>\r\n{\r\n    constructor(x: number | number[], y: number = 0, z: number = 0, w: number = 0)\r\n    {\r\n        super(4);\r\n        if (x instanceof Array)\r\n        {\r\n            this[0] = x[0];\r\n            this[1] = x[1];\r\n            this[2] = x[2];\r\n            this[3] = x[3];\r\n        }\r\n        else\r\n        {\r\n            this[0] = x;\r\n            this[1] = y;\r\n            this[2] = z;\r\n            this[3] = w;\r\n        }\r\n    }\r\n    get x():number\r\n    {\r\n        return this[0];\r\n    }\r\n    set x(value)\r\n    {\r\n        this[0] = value;\r\n    }\r\n    get y(): number\r\n    {\r\n        return this[1];\r\n    }\r\n    set y(value)\r\n    {\r\n        this[1] = value;\r\n    }\r\n    get z(): number\r\n    {\r\n        return this[2];\r\n    }\r\n    set z(value)\r\n    {\r\n        this[2] = value;\r\n    }\r\n    get w(): number\r\n    {\r\n        return this[3];\r\n    }\r\n    set w(value)\r\n    {\r\n        this[3] = value;\r\n    }\r\n    \r\n    static scale(u: Vector4, k: number):Vector4\r\n    {\r\n        return new Vector4(u.map(n => n * k));\r\n    }\r\n}\r\n\r\n\r\n\r\nfunction vec2(x: number, y: number): Vector2\r\n{\r\n    return new Vector2(x, y);\r\n}\r\nfunction vec4(x: number, y: number, z: number, w: number): Vector4\r\n{\r\n    return new Vector4(x, y, z, w);\r\n}\r\n\r\nfunction plus(u: Vector2, v: Vector2): Vector2\r\nfunction plus(u:Vector4,v:Vector4):Vector4\r\nfunction plus(u: Vector4 | Vector2, v: Vector4 | Vector2): Vector4 | Vector2\r\n{\r\n    if (u instanceof Vector2)\r\n    {\r\n        return new Vector2(u.x + v.x, u.y + v.y);\r\n    }\r\n    else if (v instanceof Vector4)\r\n    {\r\n        return new Vector4([u.x + v.x, u.y + v.y, u.z + v.z, u.w + v.w]);\r\n    }\r\n    return new Vector4(u.map((n, i) => n + v[i]));\r\n}\r\nfunction minus(u: Vector2, v: Vector2): Vector2\r\nfunction minus(u: Vector4, v: Vector4): Vector4\r\nfunction minus(u: Vector4 | Vector2, v: Vector4 | Vector2): Vector4 | Vector2\r\n{\r\n    if (u instanceof Vector2)\r\n    {\r\n        return new Vector2(u.x - v.x, u.y - v.y);\r\n    }\r\n    else if (v instanceof Vector4)\r\n    {\r\n        return new Vector4([u.x - v.x, u.y - v.y, u.z - v.z, u.w - v.w]);\r\n    }\r\n    return new Vector4(u.map((n, i) => n - v[i]));\r\n}\r\nfunction scale(u: Vector2, k: number): Vector2\r\nfunction scale(u: Vector4, k: number): Vector4\r\nfunction scale(u: Vector4 | Vector2, k: number): Vector4 | Vector2\r\n{\r\n    if (u instanceof Vector2)\r\n    {\r\n        return new Vector2(u.x *k, u.y *k);\r\n    }\r\n    else\r\n    {\r\n        return new Vector4([u.x * k, u.y * k, u.z * k, u.w * k]);\r\n    }\r\n}\r\nfunction dot(u: Vector4 | Vector2, v: Vector4 | Vector2): number\r\n{\r\n    if (u instanceof Vector2)\r\n    {\r\n        return u.x * v.x + u.y * v.y;\r\n    }\r\n    else\r\n    {\r\n        return u[0] * v[0] +\r\n            u[1] * v[1] +\r\n            u[2] * v[2] +\r\n            u[3] * v[3];\r\n    }\r\n}\r\nfunction cross(u: Vector2, v: Vector2): number\r\n{\r\n    return u.x * v.y - u.y * v.x;\r\n}\r\nclass Range extends Vector2\r\n{\r\n    get from()\r\n    {\r\n        return this[0];\r\n    }\r\n    set from(value)\r\n    {\r\n        this[0] = value;\r\n    }\r\n\r\n    get to()\r\n    {\r\n        return this[1];\r\n    }\r\n    set to(value)\r\n    {\r\n        this[1] = value;\r\n    }\r\n\r\n    get size()\r\n    {\r\n        console.log(this[1] - this[0]);\r\n        return this[1] - this[0];\r\n    }\r\n    inRange(n: number): boolean\r\n    {\r\n        return this.from < n && n < this.to;\r\n    }\r\n\r\n    inRangeInclude(n: number): boolean\r\n    {\r\n        return this.from <= n && n <= this.to;\r\n    }\r\n}\r\n\r\nexport class Rect\r\n{\r\n    offset: Vector2;\r\n    size: Vector2;\r\n    constructor(size: Vector2, offset: Vector2 = new Vector2(0, 0))\r\n    {\r\n        this.size = size;\r\n        this.offset = offset;\r\n    }\r\n    inRect(p: Vector2)\r\n    {\r\n        let dp = scale(minus(p, this.offset), 2);\r\n        return -this.size.x <= dp.x && dp.x <= this.size.x\r\n            && -this.size.y <= dp.y && dp.y <= this.size.y;\r\n    }\r\n}\r\n\r\nclass Matrix3x3 extends Array<Array<number>>\r\n{\r\n    constructor(mat: Matrix3x3 | number[][] = null)\r\n    {\r\n        super(...[\r\n            [1, 0, 0],\r\n            [0, 1, 0],\r\n            [0, 0, 1]\r\n        ]);\r\n        this[0] = [1, 0, 0];\r\n        this[1] = [0, 1, 0];\r\n        this[2] = [0, 0, 1];\r\n        if (mat instanceof Matrix3x3 || mat instanceof Array)\r\n        {\r\n            this[0] = mat[0].copyWithin(0, 0);\r\n            this[1] = mat[1].copyWithin(0, 0);\r\n            this[2] = mat[2].copyWithin(0, 0);\r\n        }\r\n    }\r\n    static get identity()\r\n    {\r\n        return new Matrix3x3();\r\n    }\r\n    static multipleVector(mat:Matrix3x3,v: Vector2): Vector2\r\n    {\r\n        let result = [\r\n            mat[0][0] * v[0] + mat[0][1] * v[1],\r\n            mat[1][0] * v[0] + mat[1][1] * v[1],\r\n            mat[2][0] * v[2] + mat[2][1] * v[1],\r\n        ]\r\n        return new Vector2(result);\r\n    }\r\n    static multiplePoint(mat: Matrix3x3, v: Vector2): Vector2\r\n    {\r\n        let result = [\r\n            mat[0][0] * v[0] + mat[0][1] * v[1] + mat[0][2] * 1,\r\n            mat[1][0] * v[0] + mat[1][1] * v[1] + mat[1][2] * 1,\r\n            mat[2][0] * v[2] + mat[2][1] * v[1] + mat[2][2] * 1,\r\n        ]\r\n        return new Vector2(result);\r\n    }\r\n    static multipleMatrix(a: Matrix3x3, b: Matrix3x3): Matrix3x3\r\n    {\r\n        let mat = new Matrix3x3();\r\n        for (let i = 0; i < 3; i++)\r\n            for (let j = 0; j < 3; j++)\r\n                for (let k = 0; k < 3; k++)\r\n                    mat[i][j] = a[i][k] * b[k][j];\r\n        return mat;\r\n    }\r\n    \r\n    multipleVector(v:Vector2): Vector2\r\n    {\r\n        return Matrix3x3.multipleVector(this, v);\r\n    }\r\n    multiplePoint(p: Vector2): Vector2\r\n    {\r\n        return Matrix3x3.multiplePoint(this, p);\r\n    }\r\n    multipleMatrix(m: Matrix3x3): Matrix3x3\r\n    {\r\n        let mat = Matrix3x3.multipleMatrix(this, m);\r\n        this[0] = mat[0].copyWithin(0, 0);\r\n        this[1] = mat[1].copyWithin(0, 0);\r\n        this[2] = mat[2].copyWithin(0, 0);\r\n        return this;\r\n    }\r\n}\r\nclass Material\r\n{\r\n    diffuseColor: Color = new Color(0, 0, 0, 1.0);\r\n    reflectivity: number = 0;\r\n    refractivity: number = 0;\r\n    emission: Color = new Color(0, 0, 0, 1.0);\r\n    constructor(emission: Color = new Color(0, 0, 0, 1.0))\r\n    {\r\n        this.emission = emission;\r\n    }\r\n}\r\n\r\nfunction mapColor(v:Vector4, k:number):Color\r\n{\r\n    return new Color(v.x * k * 255, v.y * k * 255, v.z * k * 255, 1.0);\r\n}\r\n\r\nfunction gradient(sdf: SDF,x:number,y:number, delta: number): [number, number]\r\n{\r\n    return [\r\n        (sdf(x + delta, y)[\"0\"] - sdf(x - delta, y)[\"0\"]) / (2 * delta),\r\n        (sdf(x, y + delta)[\"0\"] - sdf(x, y - delta)[\"0\"]) / (2 * delta)\r\n    ];\r\n}\r\nexport\r\n{\r\n    Color,\r\n    max,\r\n    min,\r\n    sqrt,\r\n    abs,\r\n    length,\r\n    clamp,\r\n    smin,\r\n    vec2,\r\n    Vector2,\r\n    Matrix3x3,\r\n    plus,\r\n    minus,\r\n    scale,\r\n    dot,\r\n    cross,\r\n    Vector4,\r\n    vec4,\r\n    Range,\r\n    Material,\r\n    mapColor,\r\n    gradient,\r\n};","import { RayTracer2D } from \"./trace\";\r\nimport { Color, Material, Range, Matrix3x3, Vector2 } from \"./lib\";\r\n\r\ntype SDFResult = [number, Material];\r\ntype SDF = (x: number, y: number) => SDFResult;\r\nexport interface RenderCommand\r\n{\r\n    renderType: \"preview\" | \"raytrace\"\r\n    code: string;\r\n    options: RenderOption;\r\n}\r\nexport interface RenderResult\r\n{\r\n    progress: number;\r\n    buffer: Uint8ClampedArray;\r\n}\r\nexport interface RenderOption\r\n{\r\n    [key: string]: any;\r\n    environment: EnvironmentOptions;// = new EnvironmentOptions();\r\n    raytrace: RaytraceOptions;// = new RaytraceOptions();\r\n    viewport: ViewerOptions;// = new ViewerOptions();\r\n    antiAlias: boolean;// = true;\r\n    renderOrder: RenderOrder;// = RenderOrder.Progressive;\r\n    thread: number;// = 4;\r\n    preview: boolean;// = true;\r\n}\r\nexport type SampleFunctions = \"jittered\" | \"stratified\" | \"uniform\";\r\nexport type RenderOrder = \"progressive\";\r\nexport interface EnvironmentOptions\r\n{\r\n    backgroundColor: Color;\r\n    ambient: Color;\r\n}\r\nexport interface RaytraceOptions\r\n{\r\n    sampleFunction: SampleFunctions;// = SampleFunctions.JitteredSample;\r\n    subDivide: number;// = 64;\r\n    reflectDepth: number;// = 8;\r\n    refrectDepth: number;// = 8;\r\n    hitThreshold: number;// = 0.1;\r\n}\r\nexport interface ViewerOptions\r\n{\r\n    size: Vector2;\r\n    transform: Matrix3x3;// = new Matrix3x3();\r\n}\r\n\r\nclass RenderCmd\r\n{\r\n    sdf: SDF;\r\n    renderOption: RenderOption = null;\r\n    buffer: Uint8ClampedArray = null;\r\n    xRange: Range = null;\r\n    yRange: Range = null;\r\n    constructor(renderOption: RenderOption)\r\n    {\r\n        this.renderOption = renderOption;\r\n    }\r\n}\r\n\r\nclass RenderState\r\n{\r\n    progress: number = 0;\r\n    buffer: Uint8ClampedArray = null;\r\n}\r\nfunction startRenderWorker(renderCmd: RenderCmd, outputTarget: HTMLCanvasElement)\r\n{\r\n    //renderCmd.buffer = new Uint8ClampedArray(renderCmd.xRange.length * renderCmd.yRange.length << 2);\r\n\r\n    let worker = new Worker(\"./build/renderWorker.js\");\r\n\r\n    let ctx = outputTarget.getContext(\"2d\");\r\n    worker.onmessage = (e) =>\r\n    {\r\n        let state = e.data as RenderState;\r\n        let imgData = new ImageData(state.buffer, renderCmd.xRange.size, renderCmd.yRange.size);\r\n        ctx.putImageData(imgData, renderCmd.xRange.from, renderCmd.yRange.from);\r\n        if (state.progress >= 1)\r\n            worker.terminate();\r\n    };\r\n    renderCmd.buffer;\r\n    worker.postMessage(renderCmd, [renderCmd.buffer.buffer]);\r\n}\r\n\r\nfunction renderRaytrace(sdf: SDF, renderOption: RenderOption, outputTarget:HTMLCanvasElement)\r\n{\r\n    //outputTarget.width = renderOption.width;\r\n    //outputTarget.height = renderOption.height;\r\n/*\r\n    let renderCmd = new RenderCmd(renderOption);\r\n    renderCmd.xRange = new Range(0, renderOption.viewport.size.x);\r\n    renderCmd.yRange = new Range(0, renderOption.viewport.size.y);\r\n    \r\n    let imgDta = outputTarget.getContext(\"2d\").getImageData(0, 0, renderOption.width, renderOption.height);\r\n    renderCmd.buffer = new Uint8ClampedArray(imgDta.data);\r\n    startRenderWorker(renderCmd, outputTarget);*/\r\n}\r\n\r\nfunction renderSDF(sdf: SDF, renderOption: RenderOption, outputBuffer: Uint8ClampedArray)\r\n{\r\n    const width = renderOption.viewport.size.x;\r\n    const height = renderOption.viewport.size.y;\r\n    const threshold = 1;\r\n\r\n    let imgData = new ImageData(outputBuffer, width, height);\r\n\r\n    for (let y = -height / 2 + 1; y <= height / 2; y++)\r\n    {\r\n        for (let x = -width / 2; x < width / 2; x++)\r\n        {\r\n            let [dst, mat] = sdf(x, y);\r\n            let color = renderOption.environment.backgroundColor;\r\n            if (dst <= 0)\r\n                color = mat.emission;\r\n            else if (dst < threshold)\r\n            {\r\n                var t = dst / threshold;\r\n                color = Color.blend(renderOption.environment.backgroundColor, mat.emission, 1 - t);\r\n            }\r\n\r\n            drawPixel(outputBuffer, x + width / 2, -y + height / 2, width, height, color);\r\n        }\r\n    }\r\n}\r\n\r\nfunction drawPixel(buffer: Uint8ClampedArray, x: number, y: number, width: number, height: number, color: Color)\r\n{\r\n    let idx = (y * width + x) * 4;\r\n    buffer[idx] = color.red;\r\n    buffer[idx + 1] = color.green;\r\n    buffer[idx + 2] = color.blue;\r\n    buffer[idx + 3] = Math.floor(color.alpha * 255);\r\n}\r\n\r\nexport class Renderer\r\n{\r\n    options: RenderOption;\r\n    raytracer: RayTracer2D;\r\n\r\n    constructor(options: RenderOption)\r\n    {\r\n        this.options = options;\r\n        this.raytracer = new RayTracer2D(options);\r\n    }\r\n\r\n    render(sdf: SDF, buffer: Uint8ClampedArray): void\r\n    {\r\n        \r\n    }\r\n\r\n    *renderRaytraceIterator(sdf: SDF, buffer: Uint8ClampedArray): IterableIterator<RenderResult>\r\n    {\r\n        const pixelRenderer: IterableIterator<Color>[][] = [];\r\n        const [width, height] = this.options.viewport.size;\r\n        for (let y = 0; y < height; y++)\r\n        {\r\n            pixelRenderer.push([]);\r\n            for (let x = 0; x < width; x++)\r\n            {\r\n                let p = Matrix3x3.multiplePoint(this.options.viewport.transform, new Vector2(x, y));\r\n                pixelRenderer[y].push(this.raytracer.sampleIterator(sdf, p));\r\n            }\r\n        }\r\n        for (var i = 1; i <= this.options.raytrace.subDivide; i++)\r\n        {\r\n            for (let y = 0; y < height; y++)\r\n            {\r\n                for (let x = 0; x < width; x++)\r\n                {\r\n                    let idx = (y * width + x) * 4;\r\n                    let color = pixelRenderer[y][x].next().value;\r\n                    buffer[idx] = color.red;\r\n                    buffer[idx + 1] = color.green;\r\n                    buffer[idx + 2] = color.blue;\r\n                    buffer[idx + 3] = Math.floor(color.alpha * 255);\r\n                }\r\n            }\r\n            yield {\r\n                progress: i / this.options.raytrace.subDivide,\r\n                buffer: buffer\r\n            };\r\n        }\r\n    }\r\n\r\n    renderRaytrace(sdf: SDF, buffer: Uint8ClampedArray)\r\n    {\r\n        const [width, height] = this.options.viewport.size;\r\n        for (let y = 0; y < height; y++)\r\n        {\r\n            for (let x = 0; x < width; x++)\r\n            {\r\n                let idx = (y * width + x) * 4;\r\n                let p = Matrix3x3.multiplePoint(this.options.viewport.transform, new Vector2(x, y));\r\n                let color = this.raytracer.sample(sdf, p);\r\n                buffer[idx] = color.red;\r\n                buffer[idx + 1] = color.green;\r\n                buffer[idx + 2] = color.blue;\r\n                buffer[idx + 3] = Math.floor(color.alpha * 255);\r\n            }\r\n            /*\r\n            let state = new RenderState();\r\n            state.buffer = new Uint8ClampedArray(buffer);\r\n            state.progress = y / height;\r\n            postMessage(state, undefined, [state.buffer.buffer]);*/\r\n        }\r\n        //outputTarget.width = renderOption.width;\r\n        //outputTarget.height = renderOption.height;\r\n\r\n        /*\r\n        let renderCmd = new RenderCmd(renderOption);\r\n        renderCmd.xRange = new Range(0, renderOption.width);\r\n        renderCmd.yRange = new Range(0, renderOption.height);\r\n\r\n        let imgDta = outputTarget.getContext(\"2d\").getImageData(0, 0, renderOption.width, renderOption.height);\r\n        renderCmd.buffer = new Uint8ClampedArray(imgDta.data);\r\n        startRenderWorker(renderCmd, outputTarget);*/\r\n    }\r\n\r\n    renderSDF(sdf: SDF, buffer: Uint8ClampedArray)\r\n    {\r\n        renderSDF(sdf, this.options, buffer);\r\n    }\r\n}","import { Range, Matrix3x3, Vector2, SDF, Color } from \"./lib\";\r\nimport {RenderCommand, Renderer, RenderResult} from \"./render\"\r\n\r\nonmessage = (e) =>\r\n{\r\n    console.log(\"receive\");\r\n    let renderCmd = <RenderCommand>e.data;\r\n    process(renderCmd);\r\n    \r\n}\r\n\r\nfunction report(result: RenderResult)\r\n{\r\n    postMessage(result, undefined, [result.buffer]);\r\n}\r\n\r\nfunction process(renderCmd: RenderCommand)\r\n{\r\n    function config()\r\n    { \r\n        renderCmd.options.environment.ambient = Color.from(renderCmd.options.environment.ambient);\r\n        renderCmd.options.environment.backgroundColor = Color.from(renderCmd.options.environment.ambient);\r\n        renderCmd.options.viewport.size = new Vector2(renderCmd.options.viewport.size);\r\n        renderCmd.options.viewport.transform = new Matrix3x3(renderCmd.options.viewport.transform);\r\n    }\r\n    function render(sdf: SDF)\r\n    {\r\n        const renderer = new Renderer(renderCmd.options);\r\n        let buffer = new Uint8ClampedArray(renderCmd.options.viewport.size.x * renderCmd.options.viewport.size.y * 4);\r\n        if (renderCmd.renderType == \"preview\")\r\n        {\r\n            renderer.renderSDF(sdf, buffer);\r\n            report({\r\n                progress: 1,\r\n                buffer: buffer\r\n            });\r\n        }\r\n        else if (renderCmd.renderType == \"raytrace\")\r\n        {\r\n            let N = 0;\r\n            for (const result of renderer.renderRaytraceIterator(sdf, buffer))\r\n            {\r\n                report({\r\n                    progress: result.progress,\r\n                    buffer: new Uint8ClampedArray(result.buffer.buffer)\r\n                });\r\n            }\r\n        }\r\n    }\r\n    \r\n    eval(renderCmd.code);\r\n}","import { Color, Vector2, Vector4, plus, scale, vec4, vec2, Range, Material, mapColor, gradient, minus, Rect } from \"./lib\";\r\nimport { RenderOption, SampleFunctions } from \"./render\";\r\n\r\ntype SDFResult = [number, Material];\r\ntype SDF = (x: number, y: number) => SDFResult;\r\ntype SampleFunction = (sdf: SDF, p: Vector2, subdiv: number) => Vector4;\r\n\r\nlet BoundX = new Range(-500, 500);\r\nlet BoundY = new Range(-500, 500);\r\n\r\n\r\nfunction setBound(boundX: Range, boundY: Range)\r\n{\r\n    BoundX = boundX;\r\n    BoundY = boundY;\r\n}\r\n\r\n/*function antiAlias(sdf: SDF, p: Vector2, colorCallback:Function): Vector4\r\n{\r\n    \r\n}*/\r\n\r\nexport class RayTracer2D\r\n{\r\n    options: RenderOption;\r\n    bound: Rect;\r\n\r\n    constructor(options: RenderOption)\r\n    {\r\n        this.options = options;\r\n        this.bound = new Rect(options.viewport.size);\r\n    }\r\n\r\n    trace(sdf: SDF, p: Vector2, dir: Vector2): Vector4\r\n    {\r\n        let distance: number = 0;\r\n        let material: Material;\r\n        dir = dir.normalized;\r\n        do\r\n        {\r\n            p = <Vector2>plus(p, scale(dir, distance));\r\n            [distance, material] = sdf(p.x, p.y);\r\n            if (!this.bound.inRect(p))\r\n                return this.options.environment.backgroundColor.toVector4();\r\n        }\r\n        while (distance > this.options.raytrace.hitThreshold);\r\n        return material.emission.toVector4();\r\n    }\r\n\r\n    sample(sdf: SDF, p: Vector2): Color\r\n    {\r\n        const antiAliasThreshold = 1;\r\n        let sampleFunction: (sdf: SDF, p: Vector2) => IterableIterator<Vector4>;\r\n        switch (this.options.raytrace.sampleFunction)\r\n        {\r\n            case \"jittered\":\r\n                sampleFunction = this.jitteredSample;\r\n                break;\r\n            case \"stratified\":\r\n                sampleFunction = this.stratifiedSample;\r\n                break;\r\n            case \"uniform\":\r\n                sampleFunction = this.uniformSample;\r\n                break;\r\n        }\r\n        sampleFunction = sampleFunction.bind(this);\r\n        let color = vec4(0, 0, 0, 0);\r\n        const N = this.options.raytrace.subDivide;\r\n        \r\n        for (const c of sampleFunction(sdf, p))\r\n        {\r\n            color = plus(color, c);\r\n        }\r\n\r\n        const distance = sdf(p.x, p.y)[0];\r\n        if (0 <= distance && distance <= antiAliasThreshold)\r\n        {\r\n            let grad = new Vector2(gradient(sdf, p.x, p.y, 0.1));\r\n            let pN = minus(p, scale(grad.normalized, antiAliasThreshold));\r\n            let antiAliasColor = vec4(0, 0, 0, 0);\r\n            for (const c of sampleFunction(sdf, pN))\r\n            {\r\n                antiAliasColor = plus(color, c);\r\n            }\r\n            return Color.blend(mapColor(antiAliasColor, 1 / N), mapColor(color, 1 / N), distance / antiAliasThreshold);\r\n        }\r\n        return mapColor(color, 1 / N);\r\n    }\r\n\r\n    *sampleIterator(sdf: SDF, p: Vector2): IterableIterator<Color>\r\n    {\r\n        const antiAliasThreshold = 1;\r\n        let sampleFunction: (sdf: SDF, p: Vector2) => IterableIterator<Vector4>;\r\n        switch (this.options.raytrace.sampleFunction)\r\n        {\r\n            case \"jittered\":\r\n                sampleFunction = this.jitteredSample;\r\n                break;\r\n            case \"stratified\":\r\n                sampleFunction = this.stratifiedSample;\r\n                break;\r\n            case \"uniform\":\r\n                sampleFunction = this.uniformSample;\r\n                break;\r\n        }\r\n        sampleFunction = sampleFunction.bind(this);\r\n        let color = vec4(0, 0, 0, 0);\r\n        let antiAliasColor = vec4(0, 0, 0, 0);\r\n        let n = 0;\r\n        const distance = sdf(p.x, p.y)[0];\r\n        let antiAliasIterator: IterableIterator<Vector4> = null;\r\n        if (0 <= distance && distance <= antiAliasThreshold)\r\n        {\r\n            let grad = new Vector2(gradient(sdf, p.x, p.y, 0.1));\r\n            let pN = minus(p, scale(grad.normalized, antiAliasThreshold));\r\n            antiAliasIterator = sampleFunction(sdf, pN);\r\n        }\r\n        for (const c of sampleFunction(sdf, p))\r\n        {\r\n            n++;\r\n            color = plus(color, c);\r\n            if (antiAliasIterator)\r\n            {\r\n                antiAliasColor = plus(antiAliasColor, antiAliasIterator.next().value);\r\n                yield Color.blend(mapColor(antiAliasColor, 1 / n), mapColor(color, 1 / n), distance / antiAliasThreshold);\r\n            }\r\n            else\r\n                yield mapColor(color, 1 / n);\r\n        }\r\n    }\r\n\r\n    *uniformSample(sdf: SDF, p: Vector2)\r\n    {\r\n        let color: Vector4 = vec4(0, 0, 0, 1);\r\n        for (let i = 0; i < this.options.raytrace.subDivide; i++)\r\n        {\r\n            let rad = Math.PI * 2 * Math.random();\r\n            yield this.trace(sdf, p, vec2(Math.cos(rad), Math.sin(rad)));\r\n        }\r\n        return color;\r\n    }\r\n\r\n    *stratifiedSample(sdf: SDF, p: Vector2)\r\n    {\r\n        let color: Vector4 = vec4(0, 0, 0, 1);\r\n        for (let i = 0; i < this.options.raytrace.subDivide; i++)\r\n        {\r\n            let rad = Math.PI * 2 * i / this.options.raytrace.subDivide;\r\n            yield this.trace(sdf, p, vec2(Math.cos(rad), Math.sin(rad)));\r\n        }\r\n        return color;\r\n    }\r\n    *jitteredSample(sdf: SDF, p: Vector2)\r\n    {\r\n        let color: Vector4 = vec4(0, 0, 0, 1);\r\n        const offset = Math.floor(this.options.raytrace.subDivide * Math.random());\r\n        for (let i = 0; i < this.options.raytrace.subDivide; i++)\r\n        {\r\n            \r\n            let rad = Math.PI * 2 * ((i + offset) % this.options.raytrace.subDivide + Math.random()) / this.options.raytrace.subDivide;\r\n            yield this.trace(sdf, p, vec2(Math.cos(rad), Math.sin(rad)));\r\n            //color = <Vector4>plus(this.trace(sdf, p, vec2(Math.cos(rad), Math.sin(rad))), color);\r\n        }\r\n    }\r\n\r\n}"],"sourceRoot":""}