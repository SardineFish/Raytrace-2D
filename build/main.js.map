{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/lib.ts","webpack:///./src/main.js","webpack:///./src/render.ts","webpack:///./src/shape.ts","webpack:///./src/trace.ts","webpack:///./src/transform.ts"],"names":[],"mappings":"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AAC1B;AAClD;AACA,+CAA+C;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAyD;AACzD;AACA,wCAAwC;AACxC;AACA,EAAE;AACF;AACA;AACA;AACA,WAAW,kBAAkB;AAC7B;AACA;AACA;AACA;AACA;AACA;;AAEA,0BAA0B,gBAAgB;AAC1C,0BAA0B,eAAe;AACzC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,0BAA0B,eAAe;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,IAAI;AACf,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,0BAA0B,gBAAgB;AAC1C,0BAA0B,eAAe;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,UAAU;AACrB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,MAAM;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAQA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,EAAE,IAAI,EAAE;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;;;AAGA;AACA,aAAa,+BAA+B;AAC5C;;;;;;;;;;;;;;;;;;;;;;;;ACxL+C;AAK/C;IAAA;QAEI,UAAK,GAAW,GAAG,CAAC;QACpB,WAAM,GAAW,GAAG,CAAC;QACrB,uBAAkB,GAAu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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/main.js\");\n","type SDFResult = [number, Material];\r\ntype SDF = (x: number, y: number) => SDFResult;\r\n\r\nclass Color\r\n{\r\n    red: number = 255;\r\n    green: number = 255;\r\n    blue: number = 255;\r\n    alpha: number = 1.0;\r\n    constructor(r: number, g: number, b: number, a: number = 1.0)\r\n    {\r\n        this.red = r;\r\n        this.green = g;\r\n        this.blue = b;\r\n        this.alpha = a;\r\n    }\r\n    \r\n    static add(a: Color, b: Color)\r\n    {\r\n        const t = b.alpha;\r\n        return new Color(\r\n            (1 - t) * a.red + t * b.red,\r\n            (1 - t) * a.green + t * b.green,\r\n            (1 - t) * a.blue + t * b.blue,\r\n            1 - (1 - a.alpha) * (1 - b.alpha)\r\n        );\r\n    }\r\n\r\n    static blend(a: Color, b: Color, t: number)\r\n    {\r\n        return new Color(\r\n            (1 - t) * a.red + t * b.red,\r\n            (1 - t) * a.green + t * b.green,\r\n            (1 - t) * a.blue + t * b.blue,\r\n            1\r\n        );\r\n    }\r\n\r\n    toString()\r\n    {\r\n        return `rgba(${this.red}, ${this.green}, ${this.blue}, ${this.alpha})`;\r\n    }\r\n}\r\nconst max = Math.max;\r\nconst min = Math.min;\r\nconst sqrt = Math.sqrt;\r\nconst abs = Math.abs;\r\nconst length = (x:number, y:number): number => sqrt(x * x + y * y);\r\nconst clamp = (n: number, min: number, max: number): number => n > max ? max : n < min ? min : n;\r\nconst smin = (a: number, b: number, k: number): number => -Math.log(Math.exp(-k * a) + Math.exp(-k * b)) / k;\r\n\r\nclass Vector2 extends Array<number>\r\n{\r\n    constructor(x: number|number[], y: number=0)\r\n    {\r\n        super(4);\r\n        if (x instanceof Array)\r\n        {\r\n            this[0] = x[0];\r\n            this[1] = x[1];\r\n        }\r\n        else\r\n        {\r\n            this[0] = x;\r\n            this[1] = y;\r\n        }\r\n    }\r\n    get x(): number\r\n    {\r\n        return this[0];\r\n    }\r\n    set x(value)\r\n    {\r\n        this[0] = value;\r\n    }\r\n    get y(): number\r\n    {\r\n        return this[1];\r\n    }\r\n    set y(value)\r\n    {\r\n        this[1] = value;\r\n    }\r\n    get normalized()\r\n    {\r\n        let l = Math.hypot(this.x, this.y);\r\n        return new Vector2(this.x / l, this.y / l);\r\n    }\r\n    get magnitude()\r\n    {\r\n        return Math.hypot(this[0], this[1]);\r\n    }\r\n}\r\n\r\nclass Vector4 extends Array<number>\r\n{\r\n    constructor(x: number | number[], y: number = 0, z: number = 0, w: number = 0)\r\n    {\r\n        super(4);\r\n        if (x instanceof Array)\r\n        {\r\n            this[0] = x[0];\r\n            this[1] = x[1];\r\n            this[2] = x[2];\r\n            this[3] = x[3];\r\n        }\r\n        else\r\n        {\r\n            this[0] = x;\r\n            this[1] = y;\r\n            this[2] = z;\r\n            this[3] = w;\r\n        }\r\n    }\r\n    get x():number\r\n    {\r\n        return this[0];\r\n    }\r\n    set x(value)\r\n    {\r\n        this[0] = value;\r\n    }\r\n    get y(): number\r\n    {\r\n        return this[1];\r\n    }\r\n    set y(value)\r\n    {\r\n        this[1] = value;\r\n    }\r\n    get z(): number\r\n    {\r\n        return this[2];\r\n    }\r\n    set z(value)\r\n    {\r\n        this[2] = value;\r\n    }\r\n    get w(): number\r\n    {\r\n        return this[3];\r\n    }\r\n    set w(value)\r\n    {\r\n        this[3] = value;\r\n    }\r\n    \r\n    static scale(u: Vector4, k: number):Vector4\r\n    {\r\n        return new Vector4(u.map(n => n * k));\r\n    }\r\n}\r\n\r\nfunction vec2(x: number, y: number): Vector2\r\n{\r\n    return new Vector2(x, y);\r\n}\r\nfunction vec4(x: number, y: number, z: number, w: number): Vector4\r\n{\r\n    return new Vector4(x, y, z, w);\r\n}\r\nfunction plus(u: Vector4 | Vector2, v: Vector4 | Vector2): Vector4 | Vector2\r\n{\r\n    if (u instanceof Vector2)\r\n    {\r\n        return new Vector2(u.x + v.x, u.y + v.y);\r\n    }\r\n    else if (v instanceof Vector4)\r\n    {\r\n        return new Vector4([u.x + v.x, u.y + v.y, u.z + v.z, u.w + v.w]);\r\n    }\r\n    return new Vector4(u.map((n, i) => n + v[i]));\r\n}\r\nfunction minus(u: Vector4 | Vector2, v: Vector4 | Vector2): Vector4 | Vector2\r\n{\r\n    if (u instanceof Vector2)\r\n    {\r\n        return new Vector2(u.x - v.x, u.y - v.y);\r\n    }\r\n    else if (v instanceof Vector4)\r\n    {\r\n        return new Vector4([u.x - v.x, u.y - v.y, u.z - v.z, u.w - v.w]);\r\n    }\r\n    return new Vector4(u.map((n, i) => n - v[i]));\r\n}\r\nfunction scale(u: Vector4 | Vector2, k: number): Vector4 | Vector2\r\n{\r\n    if (u instanceof Vector2)\r\n    {\r\n        return new Vector2(u.x *k, u.y *k);\r\n    }\r\n    else\r\n    {\r\n        return new Vector4([u.x * k, u.y * k, u.z * k, u.w * k]);\r\n    }\r\n}\r\nfunction dot(u: Vector4 | Vector2, v: Vector4 | Vector2): number\r\n{\r\n    if (u instanceof Vector2)\r\n    {\r\n        return u.x * v.x + u.y * v.y;\r\n    }\r\n    else\r\n    {\r\n        return u[0] * v[0] +\r\n            u[1] * v[1] +\r\n            u[2] * v[2] +\r\n            u[3] * v[3];\r\n    }\r\n}\r\nfunction cross(u: Vector2, v: Vector2): number\r\n{\r\n    return u.x * v.y - u.y * v.x;\r\n}\r\nclass Range extends Vector2\r\n{\r\n    get from()\r\n    {\r\n        return this[0];\r\n    }\r\n    set from(value)\r\n    {\r\n        this[0] = value;\r\n    }\r\n\r\n    get to()\r\n    {\r\n        return this[1];\r\n    }\r\n    set to(value)\r\n    {\r\n        this[1] = value;\r\n    }\r\n\r\n    get size()\r\n    {\r\n        console.log(this[1] - this[0]);\r\n        return this[1] - this[0];\r\n    }\r\n    inRange(n: number): boolean\r\n    {\r\n        return this.from < n && n < this.to;\r\n    }\r\n\r\n    inRangeInclude(n: number): boolean\r\n    {\r\n        return this.from <= n && n <= this.to;\r\n    }\r\n}\r\n\r\nclass Material\r\n{\r\n    diffuseColor: Color = new Color(0, 0, 0, 1.0);\r\n    reflectivity: number = 0;\r\n    refractivity: number = 0;\r\n    emission: Color = new Color(0, 0, 0, 1.0);\r\n    constructor(emission: Color = new Color(0, 0, 0, 1.0))\r\n    {\r\n        this.emission = emission;\r\n    }\r\n}\r\n\r\nfunction mapColor(v:Vector4, k:number):Color\r\n{\r\n    return new Color(v.x * k * 255, v.y * k * 255, v.z * k * 255, 1.0);\r\n}\r\n\r\nfunction gradient(sdf: SDF,x:number,y:number, delta: number): [number, number]\r\n{\r\n    return [\r\n        (sdf(x + delta, y)[\"0\"] - sdf(x - delta, y)[\"0\"]) / (2 * delta),\r\n        (sdf(x, y + delta)[\"0\"] - sdf(x, y - delta)[\"0\"]) / (2 * delta)\r\n    ];\r\n}\r\nexport\r\n{\r\n    Color,\r\n    max,\r\n    min,\r\n    sqrt,\r\n    abs,\r\n    length,\r\n    clamp,\r\n    smin,\r\n    vec2,\r\n    Vector2,\r\n    plus,\r\n    minus,\r\n    scale,\r\n    dot,\r\n    cross,\r\n    Vector4,\r\n    vec4,\r\n    Range,\r\n    Material,\r\n    mapColor,\r\n    gradient\r\n};","import { Color, Range, vec2, Vector4, Material, mapColor, gradient } from \"./lib\";\nimport { scale, translate, union, rotate, expand, subtract, repeat, displace, blend, wrapSDF, intersect } from \"./transform\";\nimport { circle, rect, torus, belt, capsule } from \"./shape\";\nimport { setBound, uniformSample, stratifiedSample, jitteredSample, sample } from \"./trace\";\nimport { RenderOption, renderSDF, renderRaytrace } from \"./render\";\n/*type SDFResult = [number, Color];\ntype SDF = (x: number, y: number) => SDFResult;*/\nconst $ = (selector) => document.querySelector(selector);\nlet renderingSDF = (x, y) => NaN;\nlet width, height;\nwindow.wkr = new Worker(\"./build/renderWorker.js\");\nwkr.onmessage = (e) => {\n\tconsole.log(e);\n};\nfunction main(t)\n{\n\tconst SubDivide = 64;\n\n\tlet c = circle(50, new Material( new Color(255, 255, 252, 1.0)));\n\tlet c2 = translate(circle(50, new Material(new Color(0, 255, 255, 1.0))), 50, 0);\n\tlet c3 = translate(circle(10, new Material(new Color(255, 255, 0, 1))), 70, 0);\n\tlet rec = translate(rect(50, 50, new Material(new Color(255, 0, 0, 1.0))), -0, -200);\n\tlet graph =\n\t\tunion(\n\t\t\tunion(\n\t\t\t\tsubtract(c, c2),\n\t\t\t\trec),\n\t\t\tc3);\n\tlet g = union(\n\t\tc,\n\t\ttranslate(circle(50, new Material(new Color(255, 0, 0, 1.0))), 50, 0)\n\t);\n\trenderingSDF = graph;\n\tlet renderOption = new RenderOption();\n\trenderOption.environmentOptions.backgroundColor = new Color(255, 128, 180, 1.0);\n\trenderSDF(graph, renderOption, $(\"#canvas\"));\n\trenderRaytrace(graph, renderOption, $(\"#canvas\"));\n\treturn;\n\tvisibleRender((x, y) =>\n\t{\n\t\t/*let [dx, dy] = gradient(graph,x,y,0.1);\n\t\treturn new Color(127 + dx * 128, 127 + dy * 128, 0, 1);*/\n\t\t/*let color = jitteredSample(graph, vec2(x, y), 0.1, SubDivide);\n\t\treturn mapColor(color, 1 / SubDivide);*/\n\t\treturn sample(graph, vec2(x, y), jitteredSample, 0.1, SubDivide);\n\t});\n}\n/**\n * \n * @param {RenderingCallback} callback \n */\nfunction customRender(callback) {\n\tconst canvas = $(\"#canvas\");\n\tconst ctx = canvas.getContext(\"2d\");\n\tctx.clearRect(0, 0, width, height);\n\tlet imgData = ctx.getImageData(0, 0, width, height);\n\n\tfor (let y = -height / 2; y < height / 2; y++) {\n\t\tfor (let x = -width / 2; x < width / 2; x++) {\n\t\t\tlet color = callback(x, y);\n\t\t\tdrawPixel(imgData, x + width / 2, -y + height / 2, width, height, color);\n\t\t}\n\t}\n\tctx.putImageData(imgData, 0, 0);\n}\n\nfunction visibleRender(callback) {\n\tconsole.log(new Date());\n\tconst canvas = $(\"#canvas\");\n\tconst ctx = canvas.getContext(\"2d\");\n\tctx.clearRect(0, 0, width, height);\n\tlet imgData = ctx.getImageData(0, 0, width, height);\n\n\tlet y = -height / 2;\n\n\tfunction update() {\n\t\tfor (let x = -width / 2; x < width / 2; x++) {\n\t\t\tlet color = callback(x, y);\n\t\t\tdrawPixel(imgData, x + width / 2, -y + height / 2, width, height, color);\n\t\t}\n\t\tctx.putImageData(imgData, 0, 0);\n\t\ty++;\n\t\tif (y < height / 2)\n\t\t\trequestAnimationFrame(update);\n\t\telse\n\t\t{\n\t\t\tconsole.log(new Date());\n\t\t}\n\t}\n\tupdate();\n}\n/**\n * \n * @param {SDF} sdf \n * @param {Color} fColor \n * @param {Color} bgColor \n * @param {Number} [threshold] \n */\nfunction render(sdf, fColor, bgColor, threshold = 1) {\n\t//renderingSDF = sdf;\n\tconst canvas = $(\"#canvas\");\n\tconst ctx = canvas.getContext(\"2d\");\n\tctx.clearRect(0, 0, width, height);\n\tlet imgData = ctx.getImageData(0, 0, width, height);\n\n\tfor (let y = -height / 2; y < height / 2; y++) {\n\t\tfor (let x = -width / 2; x < width / 2; x++) {\n\t\t\tlet d = sdf(x, y);\n\t\t\tlet color = bgColor;\n\t\t\tif (d <= 0)\n\t\t\t\tcolor = fColor;\n\t\t\telse if (d < threshold) {\n\t\t\t\tvar t = d / threshold;\n\t\t\t\tcolor = Color.blend(bgColor, fColor, 1 - t);\n\t\t\t}\n\n\t\t\tdrawPixel(imgData, x + width / 2, -y + height / 2, width, height, color);\n\t\t}\n\t}\n\tctx.putImageData(imgData, 0, 0);\n}\n/**\n * \n * @param {ImageData} imgData \n * @param {Number} x \n * @param {Number} y \n * @param {Number} width \n * @param {Number} height \n * @param {Color} color \n */\nfunction drawPixel(imgData, x, y, width, height, color) {\n\t//alert(x);\n\tlet idx = (y * width + x) * 4;\n\timgData.data[idx] = color.red;\n\timgData.data[idx + 1] = color.green;\n\timgData.data[idx + 2] = color.blue;\n\timgData.data[idx + 3] = Math.floor(color.alpha * 255);\n}\n\nexport {\n\trender,\n\tRenderingCallback,\n\tcustomRender,\n\tmapColor,\n\tvisibleRender\n};\n\nlet lastFrame = 0;\n\nfunction update(delay) {\n\trequestAnimationFrame(update);\n\tconst dt = delay - lastFrame;\n\tconst fps = Math.floor(1000 / dt);\n\t$(\"#fps\").innerText = fps;\n\tlastFrame = delay;\n\tmain(delay / 1000);\n}\n\nfunction init() {\n\twidth = window.innerWidth;\n\theight = window.innerHeight;\n\t$(\"#canvas\").width = width;\n\t$(\"#canvas\").height = height;\n\twindow.onmousemove = (e) => {\n\t\tlet x = Math.floor(e.clientX - width / 2);\n\t\tlet y = Math.floor(-(e.clientY - height / 2));\n\t\t$(\"#mouse-pos\").innerText = `(${x}, ${y})`;\n\t\t$(\"#sdf-value\").innerText = renderingSDF(x, y)[\"0\"];\n\t}\n\tsetBound(new Range(-width / 2, width / 2), new Range(-height / 2, height / 2));\n}\nwindow.onload = () => {\n\ttry {\n\t\tinit();\n\t\tmain();\n\t\t//requestAnimationFrame(update);\n\t} catch (ex) {\n\t\tconsole.error(ex.stack);\n\t\t//alert(ex.message);\n\t}\n};\n\n\t\n/**\n * @typedef {function(number,number)=>Color} RenderingCallback\n */\n\n\t","import { jitteredSample, stratifiedSample, uniformSample } from \"./trace\";\r\nimport { Color, Material, Range } from \"./lib\";\r\n\r\ntype SDFResult = [number, Material];\r\ntype SDF = (x: number, y: number) => SDFResult;\r\n\r\nclass RenderOption\r\n{\r\n    width: number = 600;\r\n    height: number = 480;\r\n    environmentOptions: EnvironmentOptions = new EnvironmentOptions();\r\n    raytraceOptions: RaytraceOptions = new RaytraceOptions();\r\n    antiAlias: boolean = true;\r\n    renderOrder: RenderOrder = RenderOrder.Progressive;\r\n    //outputTarget: HTMLCanvasElement = null;\r\n}\r\nenum SampleFunctions\r\n{\r\n    JitteredSample = \"JitteredSample\",\r\n    StratifiedSample = \"StratifiedSample\",\r\n    UniformSample = \"UniformSample\",\r\n}\r\nenum RenderOrder\r\n{\r\n    Progressive\r\n}\r\nclass EnvironmentOptions\r\n{\r\n    backgroundColor: Color = new Color(0, 0, 0, 1.0);\r\n    ambient: Color = new Color(0, 0, 0, 1.0);\r\n}\r\nclass RaytraceOptions\r\n{\r\n    sampleFunction: SampleFunctions = SampleFunctions.JitteredSample;\r\n    subDivide: number = 64;\r\n    reflectDepth: number = 8;\r\n    refrectDepth: number = 8;\r\n    hitThreshold: number = 0.1;\r\n}\r\n\r\nclass RenderCmd\r\n{\r\n    sdf: SDF;\r\n    renderOption: RenderOption = null;\r\n    buffer: Uint8ClampedArray = null;\r\n    xRange: Range = null;\r\n    yRange: Range = null;\r\n    constructor(renderOption: RenderOption)\r\n    {\r\n        this.renderOption = renderOption;\r\n    }\r\n}\r\n\r\nclass RenderState\r\n{\r\n    progress: number = 0;\r\n    buffer: Uint8ClampedArray = null;\r\n}\r\nfunction startRenderWorker(renderCmd: RenderCmd, outputTarget: HTMLCanvasElement)\r\n{\r\n    //renderCmd.buffer = new Uint8ClampedArray(renderCmd.xRange.length * renderCmd.yRange.length << 2);\r\n\r\n    let worker = new Worker(\"./build/renderWorker.js\");\r\n\r\n    let ctx = outputTarget.getContext(\"2d\");\r\n    worker.onmessage = (e) =>\r\n    {\r\n        let state = e.data as RenderState;\r\n        let imgData = new ImageData(state.buffer, renderCmd.xRange.size, renderCmd.yRange.size);\r\n        ctx.putImageData(imgData, renderCmd.xRange.from, renderCmd.yRange.from);\r\n        if (state.progress >= 1)\r\n            worker.terminate();\r\n    };\r\n    renderCmd.buffer;\r\n    worker.postMessage(renderCmd, [renderCmd.buffer.buffer]);\r\n}\r\n\r\nfunction renderRaytrace(sdf: SDF, renderOption: RenderOption, outputTarget:HTMLCanvasElement)\r\n{\r\n    //outputTarget.width = renderOption.width;\r\n    //outputTarget.height = renderOption.height;\r\n\r\n    let renderCmd = new RenderCmd(renderOption);\r\n    renderCmd.xRange = new Range(0, renderOption.width);\r\n    renderCmd.yRange = new Range(0, renderOption.height);\r\n    \r\n    let imgDta = outputTarget.getContext(\"2d\").getImageData(0, 0, renderOption.width, renderOption.height);\r\n    renderCmd.buffer = new Uint8ClampedArray(imgDta.data);\r\n    startRenderWorker(renderCmd, outputTarget);\r\n}\r\nfunction renderSDF(sdf: SDF,renderOption:RenderOption , outputTarget: HTMLCanvasElement)\r\n{\r\n    const width = renderOption.width;\r\n    const height = renderOption.height;\r\n    const threshold = 1;\r\n\r\n    outputTarget.width = width;\r\n    outputTarget.height = height;\r\n    let ctx = outputTarget.getContext(\"2d\");\r\n    let buffer = new Uint8ClampedArray(width * height << 2);\r\n    let imgData = new ImageData(buffer, width, height);\r\n\r\n    for (let y = -height / 2 + 1; y <= height / 2; y++)\r\n    {\r\n        for (let x = -width / 2; x < width / 2; x++)\r\n        {\r\n            let [dst, mat] = sdf(x, y);\r\n            let color = renderOption.environmentOptions.backgroundColor;\r\n            if (dst <= 0)\r\n                color = mat.emission;\r\n            else if (dst < threshold)\r\n            {\r\n                var t = dst / threshold;\r\n                color = Color.blend(renderOption.environmentOptions.backgroundColor, mat.emission, 1 - t);\r\n            }\r\n\r\n            drawPixel(imgData, x + width / 2, -y + height / 2, width, height, color);\r\n        }\r\n    }\r\n    ctx.putImageData(imgData, 0, 0);\r\n}\r\n\r\nfunction drawPixel(imgData: ImageData, x: number, y: number, width: number, height: number, color: Color)\r\n{\r\n    //alert(x);\r\n    let idx = (y * width + x) * 4;\r\n    imgData.data[idx] = color.red;\r\n    imgData.data[idx + 1] = color.green;\r\n    imgData.data[idx + 2] = color.blue;\r\n    imgData.data[idx + 3] = Math.floor(color.alpha * 255);\r\n}\r\nexport\r\n{\r\n    RenderOption,\r\n    SampleFunctions,\r\n    EnvironmentOptions,\r\n    RaytraceOptions,\r\n    RenderCmd,\r\n    renderRaytrace,\r\n    renderSDF,\r\n    RenderState\r\n    \r\n};","import { Material, sqrt, min, max, length, abs, clamp } from \"./lib\";\r\n\r\ntype SDFResult = [number, Material];\r\ntype SDF = (x: number, y: number) => SDFResult;\r\n\r\n/**\r\n * \r\n * @param {Number} r - radius\r\n * @param {Material} material - The material\r\n * @returns {SDF}\r\n */\r\nfunction circle(r: number, material: Material): SDF\r\n{\r\n    return (x, y) => [sqrt(x * x + y * y) - r, material];\r\n}\r\n/**\r\n * \r\n * @param {Number} w - Width of rectangle\r\n * @param {Number} h - Height of rectangle\r\n * @param {Material} material - The material\r\n * @returns {SDF}\r\n */\r\nfunction rect(w:number, h:number, material:Material): SDF\r\n{\r\n    return (x, y) =>\r\n    {\r\n        const dx = Math.abs(x) - w / 2;\r\n        const dy = Math.abs(y) - h / 2;\r\n        return [min(max(dx, dy), 0) + length(max(dx, 0), max(dy, 0)), material];\r\n    };\r\n}\r\n/**\r\n * \r\n * @param {Number} rOuter - Outer radius\r\n * @param {Number} rInner - Inner radius\r\n * @param {Material} material - The material\r\n * @returns {SDF}\r\n */\r\nfunction torus(rOuter:number, rInner:number,material:Material):SDF\r\n{\r\n    const mid = (rOuter + rInner) / 2;\r\n    const wide = (rOuter - rInner) / 2;\r\n    return (x, y) =>\r\n    {\r\n        const l = length(x, y);\r\n        return [abs(l - mid) - wide, material];\r\n    }\r\n}\r\n\r\n/**\r\n * \r\n * @param {Number} wide - Width of the belt\r\n * @param {Material} material - The material\r\n * @returns {SDF}\r\n */\r\nfunction belt(wide: number, material: Material): SDF\r\n{\r\n    return (x, y) => [y - wide / 2, material];\r\n}\r\n\r\n/**\r\n * \r\n * @param {Number} l - Length between two center of semi-circle\r\n * @param {Number} radius - The radius of the semi-circle at end\r\n * @param {Material} material - The material\r\n * @returns {SDF}\r\n */\r\nfunction capsule(l:number, radius:number, material:Material):SDF\r\n{\r\n    const half = l / 2;\r\n    return (x, y) =>\r\n    {\r\n        const dx = abs(x) - half;\r\n        return [length(clamp(dx, 0, abs(dx)), y) - radius, material];\r\n    }\r\n}\r\n\r\nexport { circle, rect, torus, belt, capsule };","import { Color, Vector2, Vector4, plus, scale, vec4, vec2, Range, Material, mapColor, gradient, minus } from \"./lib\";\r\n\r\ntype SDFResult = [number, Material];\r\ntype SDF = (x: number, y: number) => SDFResult;\r\ntype SampleFunction = (sdf: SDF, p: Vector2, precision: number, subdiv: number) => Vector4;\r\n\r\nlet BoundX = new Range(-500, 500);\r\nlet BoundY = new Range(-500, 500);\r\n\r\n\r\nfunction setBound(boundX: Range, boundY: Range)\r\n{\r\n    BoundX = boundX;\r\n    BoundY = boundY;\r\n}\r\n\r\n\r\n\r\nfunction trace(sdf: SDF, p: Vector2, dir: Vector2, precision: number): Vector4\r\n{\r\n    let distance: number = 0;\r\n    let material: Material;\r\n    dir = dir.normalized;\r\n    do\r\n    {\r\n        p = <Vector2>plus(p, scale(dir, distance));\r\n        [distance, material] = sdf(p.x, p.y);\r\n        if (!BoundX.inRange(p.x) || !BoundY.inRange(p.y))\r\n            return vec4(0, 0, 0, 1);    \r\n    }\r\n    while (distance > precision);\r\n    return vec4(material.emission.red / 255, material.emission.green / 255, material.emission.blue / 255, material.emission.alpha);\r\n}\r\n\r\n/*function antiAlias(sdf: SDF, p: Vector2, colorCallback:Function): Vector4\r\n{\r\n    \r\n}*/\r\n\r\nfunction sample(sdf: SDF, p: Vector2, sampleFunction: SampleFunction, precision: number, subdiv: number): Color\r\n{\r\n    const antiAliasThreshold =1;\r\n    let color = mapColor(sampleFunction(sdf, p, precision, subdiv), 1 / subdiv);\r\n    let distance = sdf(p.x, p.y)[\"0\"];\r\n    if (0<=distance&&distance <= antiAliasThreshold)\r\n    {\r\n        let grad = new Vector2(gradient(sdf, p.x, p.y, 0.1));\r\n        let pN = <Vector2>minus(p, scale(grad.normalized, antiAliasThreshold));\r\n        let colorN = mapColor(sampleFunction(sdf, pN, precision, subdiv), 1 / subdiv);\r\n        return Color.blend(colorN, color, distance / antiAliasThreshold);\r\n    }\r\n    return color;\r\n}\r\n\r\nfunction uniformSample(sdf: SDF, p: Vector2, precision: number, subdiv: number): Vector4\r\n{\r\n    let color: Vector4 = vec4(0, 0, 0, 1);\r\n    for (let i = 0; i < subdiv; i++)\r\n    {\r\n        let rad = Math.PI * 2 * Math.random();\r\n        color = <Vector4>plus(trace(sdf, p, vec2(Math.cos(rad), Math.sin(rad)), precision), color);\r\n    }\r\n    return color;\r\n}\r\n\r\nfunction stratifiedSample(sdf: SDF, p: Vector2, precision: number, subdiv: number): Vector4\r\n{\r\n    let color: Vector4 = vec4(0, 0, 0, 1);\r\n    for (let i = 0; i < subdiv; i++)\r\n    {\r\n        let rad = Math.PI * 2 * i / subdiv;\r\n        color = <Vector4>plus(trace(sdf, p, vec2(Math.cos(rad), Math.sin(rad)), precision), color);\r\n    }\r\n    return color;\r\n}\r\n\r\nfunction jitteredSample(sdf: SDF, p: Vector2, precision: number, subdiv: number): Vector4\r\n{\r\n    let color: Vector4 = vec4(0, 0, 0, 1);\r\n    for (let i = 0; i < subdiv; i++)\r\n    {\r\n        let rad = Math.PI * 2 * (i + Math.random()) / subdiv;\r\n        color = <Vector4>plus(trace(sdf, p, vec2(Math.cos(rad), Math.sin(rad)), precision), color);\r\n    }\r\n    return color;\r\n}\r\n\r\nexport { trace, setBound, uniformSample,stratifiedSample, jitteredSample,sample };","import { max, smin, Color } from \"./lib\";\r\nimport { Material } from \"./lib\";\r\nimport { min } from \"./lib\";\r\ntype SDFResult = [number, Material];\r\ntype SDF = (x: number, y: number) => SDFResult;\r\n/**\r\n * \r\n * @param {SDF} sdf \r\n * @param {Number} dx \r\n * @param {SDF} dy \r\n * @returns {SDF}\r\n */\r\nfunction translate(sdf:SDF, dx:number, dy:number):SDF\r\n{\r\n    return (x, y) => sdf(x - dx, y - dy);\r\n}\r\n\r\n/**\r\n * \r\n * @param {SDF} sdf \r\n * @param {Number} kx \r\n * @param {Number} [ky] \r\n * @returns {SDF}\r\n */\r\nfunction scale(sdf: SDF, kx: number, ky:number):SDF\r\n{\r\n    kx = kx === undefined ? 1 : kx;\r\n    ky = ky === undefined ? kx : ky;\r\n    return (x, y) => sdf(x / kx, y / ky);\r\n}\r\n\r\n/**\r\n * \r\n * @param {SDF} sdf \r\n * @param {Number} rad \r\n * @returns {SDF}\r\n */\r\nfunction rotate(sdf:SDF, rad:number):SDF\r\n{\r\n    const cos = Math.cos(rad);\r\n    const sin = Math.sin(rad);\r\n    return (x, y) => sdf(x * cos - y * sin, x * sin + y * cos);\r\n}\r\n\r\n/**\r\n * \r\n * @param {SDF} sdf1 \r\n * @param {SDF} sdf2 \r\n * @returns {SDF}\r\n */\r\nfunction union(sdf1:SDF, sdf2:SDF):SDF\r\n{\r\n    return (x, y) =>\r\n    {\r\n        let [d1,c1] = sdf1(x, y);\r\n        let [d2,c2] = sdf2(x, y);\r\n        if (d1 < d2)\r\n            return [d1, c1];\r\n        else\r\n            return [d2, c2];    \r\n            \r\n    }\r\n}\r\n\r\n/**\r\n * \r\n * @param {SDF} sdf1 \r\n * @param {SDF} sdf2 \r\n * @returns {SDF}\r\n */\r\nfunction subtract(sdf1:SDF, sdf2:SDF):SDF\r\n{\r\n    return (x, y) =>\r\n    {\r\n        let [d1, c1] = sdf1(x, y);\r\n        let [d2, c2] = sdf2(x, y);\r\n        d2 = -d2;\r\n        if (d1 > d2)\r\n            return [d1, c1];\r\n        else\r\n            return [d2, c1];\r\n\r\n    }\r\n}\r\n\r\n/**\r\n * \r\n * @param {SDF} sdf1 \r\n * @param {SDF} sdf2 \r\n * @returns {SDF}\r\n */\r\nfunction intersect(sdf1:SDF, sdf2:SDF)\r\n{\r\n    return (x: number, y: number) =>\r\n    {\r\n        let [d1, c1] = sdf1(x, y);\r\n        let [d2, c2] = sdf2(x, y);\r\n        if (d1 > d2)\r\n            return [d1, c1];\r\n        else\r\n            return [d2, c2];\r\n\r\n    };\r\n}\r\n\r\n/**\r\n * \r\n * @param {SDF} sdf \r\n * @param {Number} radius \r\n * @returns {SDF}\r\n */\r\nfunction expand(sdf:SDF, radius:number):SDF\r\n{\r\n    return (x, y) =>\r\n    {\r\n        let [d, c] = sdf(x, y);\r\n        return [d - radius, c];\r\n        \r\n    }\r\n}\r\n/*\r\nfunction repeat(sdf:SDF, dx, dy = dx, ox = 0, oy = 0)\r\n{\r\n    return (x, y) => sdf(x % dx + ox, y % dy + oy);\r\n}*/\r\n\r\n/**\r\n * \r\n * @param {SDF} sdf1 \r\n * @param {SDF} sdf2 \r\n * @returns {SDF}\r\n */\r\nfunction displace(sdf1:SDF, sdf2:SDF):SDF\r\n{\r\n    const m = sdf1(0, 0)[\"1\"];\r\n    return (x, y) => [sdf1(x, y)[\"0\"] + sdf2(x, y)[\"0\"], m];\r\n}\r\n\r\n/**\r\n * \r\n * @param {SDF} sdf1 \r\n * @param {SDF} sdf2 \r\n * @param {Number} k \r\n * @returns {SDF}\r\n */\r\nfunction blend(sdf1: SDF, sdf2: SDF, k:number):SDF\r\n{\r\n    const material1 = sdf1(0, 0)[\"1\"];\r\n    const material2 = sdf2(0, 0)[\"1\"];\r\n    const material = new Material();\r\n    material.emission = new Color(\r\n        smin(material1.emission.red, material2.emission.red, k),\r\n        smin(material1.emission.green, material2.emission.green, k),\r\n        smin(material1.emission.blue, material2.emission.blue, k),\r\n        smin(material1.emission.alpha, material2.emission.alpha, k));\r\n\r\n    return (x, y) => [smin(sdf1(x, y)[\"0\"], sdf2(x, y)[\"0\"], k), material];\r\n}\r\n\r\n/**\r\n * \r\n * @param sdf - The SDF function\r\n * @param material - The material to add to this object\r\n */\r\nfunction wrapSDF(sdf: SDF, material: Material): SDF\r\n{\r\n    return (x, y) => [sdf(x, y)[\"0\"], material];\r\n}\r\n\r\nexport { translate, union, scale, rotate, expand, subtract, displace, blend, wrapSDF, intersect };"],"sourceRoot":""}