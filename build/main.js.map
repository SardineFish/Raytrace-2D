{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/lib.ts","webpack:///./src/main.ts","webpack:///./src/module-hub.js","webpack:///./src/render.ts","webpack:///./src/sdf-builder.ts","webpack:///./src/shape.ts","webpack:///./src/trace.ts","webpack:///./src/transform.ts"],"names":[],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/main.ts\");\n","type SDFResult = [number, Material];\r\ntype SDF = (x: number, y: number) => SDFResult;\r\n\r\nclass Color\r\n{\r\n    red: number = 255;\r\n    green: number = 255;\r\n    blue: number = 255;\r\n    alpha: number = 1.0;\r\n    constructor(r: number, g: number, b: number, a: number = 1.0)\r\n    {\r\n        this.red = r;\r\n        this.green = g;\r\n        this.blue = b;\r\n        this.alpha = a;\r\n    }\r\n\r\n    get hue(): number\r\n    {\r\n        const R = this.red / 255;\r\n        const G = this.green / 255;\r\n        const B = this.blue / 255;\r\n        const max = Math.max(R, G, B);\r\n        const min = Math.min(R, G, B);\r\n        let h;\r\n        if (max === min)\r\n            h = 0;\r\n        else if (max === R)\r\n            h = 60 * (0 + (G - B) / (max - min));\r\n        else if (max === G)\r\n            h = 60 * (2 + (B - R) / (max - min));\r\n        else if (max === B)\r\n            h = 60 * (4 + (R - G) / (max - min));\r\n        return h < 0 ? h + 360 : h;\r\n    }\r\n    get saturation(): number\r\n    {\r\n        const max = Math.max(this.red, this.green, this.blue) / 255;\r\n        const min = Math.min(this.red, this.blue, this.green) / 255;\r\n        if (max === 0)\r\n            return 0\r\n        else if (min == 1)\r\n            return 0;\r\n        return (max - min) / (1 - Math.abs(max + min - 1));\r\n    }\r\n    get lightness(): number\r\n    {\r\n        const max = Math.max(this.red, this.green, this.blue) / 255;\r\n        const min = Math.min(this.red, this.blue, this.green) / 255;\r\n        return (max + min) / 2;\r\n    }\r\n\r\n    set hue(value: number)\r\n    {\r\n        this.setHSL(value, this.saturation, this.lightness);\r\n    }\r\n    set saturation(value: number)\r\n    {\r\n        this.setHSL(this.hue, value, this.lightness);\r\n    }\r\n    set lightness(value: number)\r\n    {\r\n        this.setHSL(this.hue, this.saturation, value);\r\n    }\r\n\r\n    static add(a: Color, b: Color)\r\n    {\r\n        const t = b.alpha;\r\n        return new Color(\r\n            (1 - t) * a.red + t * b.red,\r\n            (1 - t) * a.green + t * b.green,\r\n            (1 - t) * a.blue + t * b.blue,\r\n            1 - (1 - a.alpha) * (1 - b.alpha)\r\n        );\r\n    }\r\n\r\n    static blend(a: Color, b: Color, t: number)\r\n    {\r\n        return new Color(\r\n            (1 - t) * a.red + t * b.red,\r\n            (1 - t) * a.green + t * b.green,\r\n            (1 - t) * a.blue + t * b.blue,\r\n            1\r\n        );\r\n    }\r\n\r\n    static fromHSL(h: number, s: number, l: number, alpha: number = 1)\r\n    {\r\n        return new Color(0, 0, 0, alpha).setHSL(h, s, l);\r\n    }\r\n\r\n    setHSL(h: number, s: number, l: number)\r\n    {\r\n        h = h < 0 ? h + 360 : h;\r\n        const chroma = (1 - Math.abs(2 * l - 1)) * s;\r\n        if (isNaN(h))\r\n        {\r\n            this.red = this.green = this.blue = 0;\r\n            return this;\r\n        }\r\n        h = h / 60;\r\n        const x = chroma * (1 - Math.abs(h % 2 - 1));\r\n        let color = [0, 0, 0];\r\n        if (0 <= h && h <= 1)\r\n            color = [chroma, x, 0];\r\n        else if (h <= 2)\r\n            color = [x, chroma, 0]\r\n        else if (h <= 3)\r\n            color = [0, chroma, x];\r\n        else if (h <= 4)\r\n            color = [0, x, chroma];\r\n        else if (h <= 5)\r\n            color = [x, 0, chroma];\r\n        else if (h <= 6)\r\n            color = [chroma, 0, x];\r\n        let m = l - chroma / 2;\r\n        this.red = Math.floor((color[0] + m) * 255);\r\n        this.green = Math.floor((color[1] + m) * 255);\r\n        this.blue = Math.floor((color[2] + m) * 255);\r\n        return this;\r\n    }\r\n\r\n    static fromString(str: string, alpha: number = 1): Color\r\n    {\r\n        str = str.replace(new RegExp(/\\s/g), \"\");\r\n\r\n        var reg = new RegExp(\"#[0-9a-fA-F]{6}\");\r\n        if (reg.test(str))\r\n        {\r\n            str = str.replace(\"#\", \"\");\r\n            var strR = str.charAt(0) + str.charAt(1);\r\n            var strG = str.charAt(2) + str.charAt(3);\r\n            var strB = str.charAt(4) + str.charAt(5);\r\n            var r = parseInt(strR, 16);\r\n            var g = parseInt(strG, 16);\r\n            var b = parseInt(strB, 16);\r\n            return new Color(r, g, b, alpha);\r\n        }\r\n        reg = new RegExp(\"rgb\\\\(([0-9]+(\\\\.[0-9]+){0,1}),([0-9]+(\\\\.[0-9]+){0,1}),([0-9]+(\\\\.[0-9]+){0,1})\\\\)\");\r\n        if (reg.test(str))\r\n        {\r\n            var colorArray = str.replace(\"rgb(\", \"\").replace(\")\", \"\").split(\",\");\r\n            var r = parseInt(colorArray[0]);\r\n            var g = parseInt(colorArray[1]);\r\n            var b = parseInt(colorArray[2]);\r\n            var a = 1.00;\r\n            return new Color(r, g, b, a);\r\n        }\r\n        reg = new RegExp(\"rgba\\\\(([0-9]+(\\\\.[0-9]+){0,1}),([0-9]+(\\\\.[0-9]+){0,1}),([0-9]+(\\\\.[0-9]+){0,1}),([0-9]+(\\\\.[0-9]+){0,1})\\\\)\");\r\n        if (reg.test(str))\r\n        {\r\n            var colorArray = str.replace(\"rgba(\", \"\").replace(\")\", \"\").split(\",\");\r\n            var r = parseInt(colorArray[0]);\r\n            var g = parseInt(colorArray[1]);\r\n            var b = parseInt(colorArray[2]);\r\n            var a = parseFloat(colorArray[3]);\r\n            return new Color(r, g, b, a);\r\n        }\r\n    }\r\n\r\n    toString()\r\n    {\r\n        return `rgba(${this.red},${this.green},${this.blue},${this.alpha})`;\r\n    }\r\n    toVector4(): Vector4\r\n    {\r\n        return new Vector4(this.red / 255, this.green / 255, this.blue / 255, this.alpha);\r\n    }\r\n}\r\nconst max = Math.max;\r\nconst min = Math.min;\r\nconst sqrt = Math.sqrt;\r\nconst abs = Math.abs;\r\nconst length = (x:number, y:number): number => sqrt(x * x + y * y);\r\nconst clamp = (n: number, min: number, max: number): number => n > max ? max : n < min ? min : n;\r\nconst smin = (a: number, b: number, k: number): number => -Math.log(Math.exp(-k * a) + Math.exp(-k * b)) / k;\r\n\r\nclass Vector2 extends Array<number>\r\n{\r\n    constructor(x: number|number[], y: number=0)\r\n    {\r\n        super(4);\r\n        if (x instanceof Array)\r\n        {\r\n            this[0] = x[0];\r\n            this[1] = x[1];\r\n        }\r\n        else\r\n        {\r\n            this[0] = x;\r\n            this[1] = y;\r\n        }\r\n    }\r\n    get x(): number\r\n    {\r\n        return this[0];\r\n    }\r\n    set x(value)\r\n    {\r\n        this[0] = value;\r\n    }\r\n    get y(): number\r\n    {\r\n        return this[1];\r\n    }\r\n    set y(value)\r\n    {\r\n        this[1] = value;\r\n    }\r\n    get normalized()\r\n    {\r\n        let l = Math.hypot(this.x, this.y);\r\n        return new Vector2(this.x / l, this.y / l);\r\n    }\r\n    get magnitude()\r\n    {\r\n        return Math.hypot(this[0], this[1]);\r\n    }\r\n}\r\n\r\nclass Vector4 extends Array<number>\r\n{\r\n    constructor(x: number | number[], y: number = 0, z: number = 0, w: number = 0)\r\n    {\r\n        super(4);\r\n        if (x instanceof Array)\r\n        {\r\n            this[0] = x[0];\r\n            this[1] = x[1];\r\n            this[2] = x[2];\r\n            this[3] = x[3];\r\n        }\r\n        else\r\n        {\r\n            this[0] = x;\r\n            this[1] = y;\r\n            this[2] = z;\r\n            this[3] = w;\r\n        }\r\n    }\r\n    get x():number\r\n    {\r\n        return this[0];\r\n    }\r\n    set x(value)\r\n    {\r\n        this[0] = value;\r\n    }\r\n    get y(): number\r\n    {\r\n        return this[1];\r\n    }\r\n    set y(value)\r\n    {\r\n        this[1] = value;\r\n    }\r\n    get z(): number\r\n    {\r\n        return this[2];\r\n    }\r\n    set z(value)\r\n    {\r\n        this[2] = value;\r\n    }\r\n    get w(): number\r\n    {\r\n        return this[3];\r\n    }\r\n    set w(value)\r\n    {\r\n        this[3] = value;\r\n    }\r\n    \r\n    static scale(u: Vector4, k: number):Vector4\r\n    {\r\n        return new Vector4(u.map(n => n * k));\r\n    }\r\n}\r\n\r\n\r\n\r\nfunction vec2(x: number, y: number): Vector2\r\n{\r\n    return new Vector2(x, y);\r\n}\r\nfunction vec4(x: number, y: number, z: number, w: number): Vector4\r\n{\r\n    return new Vector4(x, y, z, w);\r\n}\r\nfunction plus(u: Vector4 | Vector2, v: Vector4 | Vector2): Vector4 | Vector2\r\n{\r\n    if (u instanceof Vector2)\r\n    {\r\n        return new Vector2(u.x + v.x, u.y + v.y);\r\n    }\r\n    else if (v instanceof Vector4)\r\n    {\r\n        return new Vector4([u.x + v.x, u.y + v.y, u.z + v.z, u.w + v.w]);\r\n    }\r\n    return new Vector4(u.map((n, i) => n + v[i]));\r\n}\r\nfunction minus(u: Vector4 | Vector2, v: Vector4 | Vector2): Vector4 | Vector2\r\n{\r\n    if (u instanceof Vector2)\r\n    {\r\n        return new Vector2(u.x - v.x, u.y - v.y);\r\n    }\r\n    else if (v instanceof Vector4)\r\n    {\r\n        return new Vector4([u.x - v.x, u.y - v.y, u.z - v.z, u.w - v.w]);\r\n    }\r\n    return new Vector4(u.map((n, i) => n - v[i]));\r\n}\r\nfunction scale(u: Vector4 | Vector2, k: number): Vector4 | Vector2\r\n{\r\n    if (u instanceof Vector2)\r\n    {\r\n        return new Vector2(u.x *k, u.y *k);\r\n    }\r\n    else\r\n    {\r\n        return new Vector4([u.x * k, u.y * k, u.z * k, u.w * k]);\r\n    }\r\n}\r\nfunction dot(u: Vector4 | Vector2, v: Vector4 | Vector2): number\r\n{\r\n    if (u instanceof Vector2)\r\n    {\r\n        return u.x * v.x + u.y * v.y;\r\n    }\r\n    else\r\n    {\r\n        return u[0] * v[0] +\r\n            u[1] * v[1] +\r\n            u[2] * v[2] +\r\n            u[3] * v[3];\r\n    }\r\n}\r\nfunction cross(u: Vector2, v: Vector2): number\r\n{\r\n    return u.x * v.y - u.y * v.x;\r\n}\r\nclass Range extends Vector2\r\n{\r\n    get from()\r\n    {\r\n        return this[0];\r\n    }\r\n    set from(value)\r\n    {\r\n        this[0] = value;\r\n    }\r\n\r\n    get to()\r\n    {\r\n        return this[1];\r\n    }\r\n    set to(value)\r\n    {\r\n        this[1] = value;\r\n    }\r\n\r\n    get size()\r\n    {\r\n        console.log(this[1] - this[0]);\r\n        return this[1] - this[0];\r\n    }\r\n    inRange(n: number): boolean\r\n    {\r\n        return this.from < n && n < this.to;\r\n    }\r\n\r\n    inRangeInclude(n: number): boolean\r\n    {\r\n        return this.from <= n && n <= this.to;\r\n    }\r\n}\r\n\r\nexport class Rect\r\n{\r\n    offset: Vector2;\r\n    size: Vector2;\r\n    constructor(size: Vector2, offset: Vector2 = new Vector2(0, 0))\r\n    {\r\n        this.size = size;\r\n        this.offset = offset;\r\n    }\r\n    inRect(p: Vector2)\r\n    {\r\n        let dp = scale(minus(p, this.offset), 2);\r\n        return -this.size.x <= dp.x && dp.x <= this.size.x\r\n            && -this.size.y <= dp.y && dp.y <= this.size.y;\r\n    }\r\n}\r\n\r\nclass Matrix3x3\r\n{\r\n    constructor(mat: Matrix3x3 | number[][] = null)\r\n    {\r\n        this[0] = [1, 0, 0];\r\n        this[1] = [0, 1, 0];\r\n        this[2] = [0, 0, 1];\r\n        if (mat instanceof Matrix3x3 || mat instanceof Array)\r\n        {\r\n            this[0] = mat[0].copyWithin(0, 0);\r\n            this[1] = mat[1].copyWithin(0, 0);\r\n            this[2] = mat[2].copyWithin(0, 0);\r\n        }\r\n    }\r\n    [indexer: number]: number[];\r\n    static get identity()\r\n    {\r\n        return new Matrix3x3();\r\n    }\r\n    static multipleVector(mat:Matrix3x3,v: Vector2): Vector2\r\n    {\r\n        let result = [\r\n            mat[0][0] * v[0] + mat[0][1] * v[1],\r\n            mat[1][0] * v[0] + mat[1][1] * v[1],\r\n            mat[2][0] * v[2] + mat[2][1] * v[1],\r\n        ]\r\n        return new Vector2(result);\r\n    }\r\n    static multiplePoint(mat: Matrix3x3, v: Vector2): Vector2\r\n    {\r\n        let result = [\r\n            mat[0][0] * v[0] + mat[0][1] * v[1] + mat[0][2] * 1,\r\n            mat[1][0] * v[0] + mat[1][1] * v[1] + mat[1][2] * 1,\r\n            mat[2][0] * v[2] + mat[2][1] * v[1] + mat[2][2] * 1,\r\n        ]\r\n        return new Vector2(result);\r\n    }\r\n    static multipleMatrix(a: Matrix3x3, b: Matrix3x3): Matrix3x3\r\n    {\r\n        let mat = new Matrix3x3();\r\n        for (let i = 0; i < 3; i++)\r\n            for (let j = 0; j < 3; j++)\r\n                for (let k = 0; k < 3; k++)\r\n                    mat[i][j] = a[i][k] * b[k][j];\r\n        return mat;\r\n    }\r\n    \r\n    multipleVector(v:Vector2): Vector2\r\n    {\r\n        return Matrix3x3.multipleVector(this, v);\r\n    }\r\n    multiplePoint(p: Vector2): Vector2\r\n    {\r\n        return Matrix3x3.multiplePoint(this, p);\r\n    }\r\n    multipleMatrix(m: Matrix3x3): Matrix3x3\r\n    {\r\n        let mat = Matrix3x3.multipleMatrix(this, m);\r\n        this[0] = mat[0].copyWithin(0, 0);\r\n        this[1] = mat[1].copyWithin(0, 0);\r\n        this[2] = mat[2].copyWithin(0, 0);\r\n        return this;\r\n    }\r\n}\r\nclass Material\r\n{\r\n    diffuseColor: Color = new Color(0, 0, 0, 1.0);\r\n    reflectivity: number = 0;\r\n    refractivity: number = 0;\r\n    emission: Color = new Color(0, 0, 0, 1.0);\r\n    constructor(emission: Color = new Color(0, 0, 0, 1.0))\r\n    {\r\n        this.emission = emission;\r\n    }\r\n}\r\n\r\nfunction mapColor(v:Vector4, k:number):Color\r\n{\r\n    return new Color(v.x * k * 255, v.y * k * 255, v.z * k * 255, 1.0);\r\n}\r\n\r\nfunction gradient(sdf: SDF,x:number,y:number, delta: number): [number, number]\r\n{\r\n    return [\r\n        (sdf(x + delta, y)[\"0\"] - sdf(x - delta, y)[\"0\"]) / (2 * delta),\r\n        (sdf(x, y + delta)[\"0\"] - sdf(x, y - delta)[\"0\"]) / (2 * delta)\r\n    ];\r\n}\r\nexport\r\n{\r\n    Color,\r\n    max,\r\n    min,\r\n    sqrt,\r\n    abs,\r\n    length,\r\n    clamp,\r\n    smin,\r\n    vec2,\r\n    Vector2,\r\n    Matrix3x3,\r\n    plus,\r\n    minus,\r\n    scale,\r\n    dot,\r\n    cross,\r\n    Vector4,\r\n    vec4,\r\n    Range,\r\n    Material,\r\n    mapColor,\r\n    gradient,\r\n};","import { Color, Range, vec2, Vector4, Material, mapColor, gradient, Matrix3x3 } from \"./lib\";\nimport { scale, translate, union, rotate, expand, subtract, displace, blend, wrapSDF, intersect } from \"./transform\";\nimport { circle, rect, torus, belt, capsule } from \"./shape\";\nimport { RenderOption, Renderer } from \"./render\";\n/*type SDFResult = [number, Color];\ntype SDF = (x: number, y: number) => SDFResult;*/\nconst $ = (selector: string) => document.querySelector(selector);\nlet renderingSDF = (x: number, y: number) => NaN;\nlet width: number, height: number;\n/*window.wkr = new Worker(\"./build/renderWorker.js\");\nwkr.onmessage = (e) => {\n\tconsole.log(e);\n};*/\n/*let testWorker = new Worker(\"./build/testWorker.js\");\ntestWorker.onmessage = (e) =>\n{\n\tconsole.log(FunctionRecaller.recall(e.data));\n}*/\nfunction main(t?:number)\n{\n\tconst SubDivide = 64;\n\n\tlet c = circle(50, new Material(new Color(255, 255, 252, 1.0)));\n\t/*testWorker.postMessage(c.recaller);\n\treturn;*/\n\tlet c2 = translate(circle(50, new Material(new Color(0, 255, 255, 1.0))), 50, 0);\n\tlet c3 = translate(circle(10, new Material(new Color(255, 255, 0, 1))), 70, 0);\n\tlet rec = translate(rect(50, 50, new Material(new Color(255, 0, 0, 1.0))), -0, -200);\n\tlet graph =\n\t\tunion(\n\t\t\tunion(\n\t\t\t\tsubtract(c, c2),\n\t\t\t\trec),\n\t\t\tc3);\n\tlet g = union(\n\t\tc,\n\t\ttranslate(circle(50, new Material(new Color(255, 0, 0, 1.0))), 50, 0)\n\t);\n\t/*console.log(graph.toString());\n\trenderingSDF = graph;\n\tlet renderOption = new RenderOption();\n\trenderOption.environment.backgroundColor = new Color(255, 128, 180, 1.0);\n\trenderSDF(graph, renderOption, $(\"#canvas\"));\n\trenderRaytrace(graph, renderOption, $(\"#canvas\"));*/\n\n\tconst renderer = new Renderer({\n\t\tenvironment: {\n\t\t\tambient: new Color(0, 0, 0),\n\t\t\tbackgroundColor: new Color(0, 0, 0),\n\t\t},\n\t\traytrace: {\n\t\t\thitThreshold: 0.01,\n\t\t\treflectDepth: 8,\n\t\t\trefrectDepth: 8,\n\t\t\tsampleFunction: \"jittered\",\n\t\t\tsubDivide: 2\n\t\t},\n\t\trenderOrder: \"progressive\",\n\t\tviewport: {\n\t\t\tsize: vec2(800, 600),\n\t\t\ttransform: new Matrix3x3([\n\t\t\t\t[1, 0, -400 + 1],\n\t\t\t\t[0, 1, -300 + 1],\n\t\t\t\t[0, 0, 1]\n\t\t\t])\n\t\t},\n\t\tantiAlias: true\n\t})\n\tvar buffer = new Uint8ClampedArray(800 * 600 * 4);\n\trenderer.renderRaytrace(graph, buffer);\n\tvar imgData = new ImageData(buffer, 800, 600);\n\t($(\"#canvas\") as HTMLCanvasElement).getContext(\"2d\").putImageData(imgData, 0, 0);\n\treturn;\n\t/*visibleRender((x, y) =>\n\t{\n\t\t/*let [dx, dy] = gradient(graph,x,y,0.1);\n\t\treturn new Color(127 + dx * 128, 127 + dy * 128, 0, 1);*/\n\t\t/*let color = jitteredSample(graph, vec2(x, y), 0.1, SubDivide);\n\t\treturn mapColor(color, 1 / SubDivide);/\n\t\treturn sample(graph, vec2(x, y), jitteredSample, 0.1, SubDivide);\n\t});*/\n}\n\n/*\nfunction customRender(callback) {\n\tconst canvas = $(\"#canvas\");\n\tconst ctx = canvas.getContext(\"2d\");\n\tctx.clearRect(0, 0, width, height);\n\tlet imgData = ctx.getImageData(0, 0, width, height);\n\n\tfor (let y = -height / 2; y < height / 2; y++) {\n\t\tfor (let x = -width / 2; x < width / 2; x++) {\n\t\t\tlet color = callback(x, y);\n\t\t\tdrawPixel(imgData, x + width / 2, -y + height / 2, width, height, color);\n\t\t}\n\t}\n\tctx.putImageData(imgData, 0, 0);\n}\n\nfunction visibleRender(callback) {\n\tconsole.log(new Date());\n\tconst canvas = $(\"#canvas\");\n\tconst ctx = canvas.getContext(\"2d\");\n\tctx.clearRect(0, 0, width, height);\n\tlet imgData = ctx.getImageData(0, 0, width, height);\n\n\tlet y = -height / 2;\n\n\tfunction update() {\n\t\tfor (let x = -width / 2; x < width / 2; x++) {\n\t\t\tlet color = callback(x, y);\n\t\t\tdrawPixel(imgData, x + width / 2, -y + height / 2, width, height, color);\n\t\t}\n\t\tctx.putImageData(imgData, 0, 0);\n\t\ty++;\n\t\tif (y < height / 2)\n\t\t\trequestAnimationFrame(update);\n\t\telse\n\t\t{\n\t\t\tconsole.log(new Date());\n\t\t}\n\t}\n\tupdate();\n}\n\nfunction render(sdf, fColor, bgColor, threshold = 1) {\n\t//renderingSDF = sdf;\n\tconst canvas = $(\"#canvas\");\n\tconst ctx = canvas.getContext(\"2d\");\n\tctx.clearRect(0, 0, width, height);\n\tlet imgData = ctx.getImageData(0, 0, width, height);\n\n\tfor (let y = -height / 2; y < height / 2; y++) {\n\t\tfor (let x = -width / 2; x < width / 2; x++) {\n\t\t\tlet d = sdf(x, y);\n\t\t\tlet color = bgColor;\n\t\t\tif (d <= 0)\n\t\t\t\tcolor = fColor;\n\t\t\telse if (d < threshold) {\n\t\t\t\tvar t = d / threshold;\n\t\t\t\tcolor = Color.blend(bgColor, fColor, 1 - t);\n\t\t\t}\n\n\t\t\tdrawPixel(imgData, x + width / 2, -y + height / 2, width, height, color);\n\t\t}\n\t}\n\tctx.putImageData(imgData, 0, 0);\n}\nfunction drawPixel(imgData, x, y, width, height, color) {\n\t//alert(x);\n\tlet idx = (y * width + x) * 4;\n\timgData.data[idx] = color.red;\n\timgData.data[idx + 1] = color.green;\n\timgData.data[idx + 2] = color.blue;\n\timgData.data[idx + 3] = Math.floor(color.alpha * 255);\n}\n\nexport {\n\trender,\n\tRenderingCallback,\n\tcustomRender,\n\tmapColor,\n\tvisibleRender\n};\n\nlet lastFrame = 0;\n\nfunction update(delay) {\n\trequestAnimationFrame(update);\n\tconst dt = delay - lastFrame;\n\tconst fps = Math.floor(1000 / dt);\n\t$(\"#fps\").innerText = fps;\n\tlastFrame = delay;\n\tmain(delay / 1000);\n}\n*/\nfunction init() {\n\twidth = window.innerWidth;\n\theight = window.innerHeight;\n\tdocument.querySelector\n\t$(\"#canvas\").width = width;\n\t$(\"#canvas\").height = height;\n\twindow.onmousemove = (e) => {\n\t\tlet x = Math.floor(e.clientX - width / 2);\n\t\tlet y = Math.floor(-(e.clientY - height / 2));\n\t\t/*$(\"#mouse-pos\").innerText = `(${x}, ${y})`;\n\t\t$(\"#sdf-value\").innerText = renderingSDF(x, y)[\"0\"];*/\n\t}\n\t//setBound(new Range(-width / 2, width / 2), new Range(-height / 2, height / 2));\n}\nwindow.onload = () => {\n\ttry {\n\t\tinit();\n\t\tmain();\n\t\t//requestAnimationFrame(update);\n\t} catch (ex) {\n\t\tconsole.error(ex.stack);\n\t\t//alert(ex.message);\n\t}\n};\n\n\t\n/**\n * @typedef {function(number,number)=>Color} RenderingCallback\n */\n\n\t","/**\r\n * To solve the problem cause by Webpack.\r\n */\r\n\r\nimport { BuildSDF } from \"./sdf-builder\";\r\nwindow.moduleHub = {\r\n    BuildSDF: BuildSDF\r\n};\r\n\r\nexport { moduleHub };","import { RayTracer2D } from \"./trace\";\r\nimport { Color, Material, Range, Matrix3x3, Vector2 } from \"./lib\";\r\n\r\ntype SDFResult = [number, Material];\r\ntype SDF = (x: number, y: number) => SDFResult;\r\nexport interface RanderCommand\r\n{\r\n    code: string;\r\n    options: RenderOption;\r\n}\r\nexport interface RenderOption\r\n{\r\n    environment: EnvironmentOptions;// = new EnvironmentOptions();\r\n    raytrace: RaytraceOptions;// = new RaytraceOptions();\r\n    viewport: ViewerOptions;// = new ViewerOptions();\r\n    antiAlias: boolean;// = true;\r\n    renderOrder: RenderOrder;// = RenderOrder.Progressive;\r\n    //outputTarget: HTMLCanvasElement;// = null;\r\n}\r\nexport type SampleFunctions = \"jittered\" | \"stratified\" | \"uniform\";\r\nexport type RenderOrder = \"progressive\";\r\nexport interface EnvironmentOptions\r\n{\r\n    backgroundColor: Color;\r\n    ambient: Color;\r\n}\r\nexport interface RaytraceOptions\r\n{\r\n    sampleFunction: SampleFunctions;// = SampleFunctions.JitteredSample;\r\n    subDivide: number;// = 64;\r\n    reflectDepth: number;// = 8;\r\n    refrectDepth: number;// = 8;\r\n    hitThreshold: number;// = 0.1;\r\n}\r\nexport interface ViewerOptions\r\n{\r\n    size: Vector2;\r\n    transform: Matrix3x3;// = new Matrix3x3();\r\n}\r\n\r\nclass RenderCmd\r\n{\r\n    sdf: SDF;\r\n    renderOption: RenderOption = null;\r\n    buffer: Uint8ClampedArray = null;\r\n    xRange: Range = null;\r\n    yRange: Range = null;\r\n    constructor(renderOption: RenderOption)\r\n    {\r\n        this.renderOption = renderOption;\r\n    }\r\n}\r\n\r\nclass RenderState\r\n{\r\n    progress: number = 0;\r\n    buffer: Uint8ClampedArray = null;\r\n}\r\nfunction startRenderWorker(renderCmd: RenderCmd, outputTarget: HTMLCanvasElement)\r\n{\r\n    //renderCmd.buffer = new Uint8ClampedArray(renderCmd.xRange.length * renderCmd.yRange.length << 2);\r\n\r\n    let worker = new Worker(\"./build/renderWorker.js\");\r\n\r\n    let ctx = outputTarget.getContext(\"2d\");\r\n    worker.onmessage = (e) =>\r\n    {\r\n        let state = e.data as RenderState;\r\n        let imgData = new ImageData(state.buffer, renderCmd.xRange.size, renderCmd.yRange.size);\r\n        ctx.putImageData(imgData, renderCmd.xRange.from, renderCmd.yRange.from);\r\n        if (state.progress >= 1)\r\n            worker.terminate();\r\n    };\r\n    renderCmd.buffer;\r\n    worker.postMessage(renderCmd, [renderCmd.buffer.buffer]);\r\n}\r\n\r\nfunction renderRaytrace(sdf: SDF, renderOption: RenderOption, outputTarget:HTMLCanvasElement)\r\n{\r\n    //outputTarget.width = renderOption.width;\r\n    //outputTarget.height = renderOption.height;\r\n/*\r\n    let renderCmd = new RenderCmd(renderOption);\r\n    renderCmd.xRange = new Range(0, renderOption.viewport.size.x);\r\n    renderCmd.yRange = new Range(0, renderOption.viewport.size.y);\r\n    \r\n    let imgDta = outputTarget.getContext(\"2d\").getImageData(0, 0, renderOption.width, renderOption.height);\r\n    renderCmd.buffer = new Uint8ClampedArray(imgDta.data);\r\n    startRenderWorker(renderCmd, outputTarget);*/\r\n}\r\n\r\nfunction renderSDF(sdf: SDF, renderOption: RenderOption, outputBuffer: Uint8ClampedArray)\r\n{\r\n    const width = renderOption.viewport.size.x;\r\n    const height = renderOption.viewport.size.y;\r\n    const threshold = 1;\r\n\r\n    let imgData = new ImageData(outputBuffer, width, height);\r\n\r\n    for (let y = -height / 2 + 1; y <= height / 2; y++)\r\n    {\r\n        for (let x = -width / 2; x < width / 2; x++)\r\n        {\r\n            let [dst, mat] = sdf(x, y);\r\n            let color = renderOption.environment.backgroundColor;\r\n            if (dst <= 0)\r\n                color = mat.emission;\r\n            else if (dst < threshold)\r\n            {\r\n                var t = dst / threshold;\r\n                color = Color.blend(renderOption.environment.backgroundColor, mat.emission, 1 - t);\r\n            }\r\n\r\n            drawPixel(outputBuffer, x + width / 2, -y + height / 2, width, height, color);\r\n        }\r\n    }\r\n}\r\n\r\nfunction drawPixel(buffer: Uint8ClampedArray, x: number, y: number, width: number, height: number, color: Color)\r\n{\r\n    let idx = (y * width + x) * 4;\r\n    buffer[idx] = color.red;\r\n    buffer[idx + 1] = color.green;\r\n    buffer[idx + 2] = color.blue;\r\n    buffer[idx + 3] = Math.floor(color.alpha * 255);\r\n}\r\n\r\nexport class Renderer\r\n{\r\n    options: RenderOption;\r\n    raytracer: RayTracer2D;\r\n\r\n    constructor(options: RenderOption)\r\n    {\r\n        this.options = options;\r\n        this.raytracer = new RayTracer2D(options);\r\n    }\r\n\r\n    render(sdf: SDF, buffer: Uint8ClampedArray): void\r\n    {\r\n        \r\n    }\r\n\r\n    renderRaytrace(sdf: SDF, buffer: Uint8ClampedArray)\r\n    {\r\n        const [width, height] = this.options.viewport.size;\r\n        for (let y = 0; y < height; y++)\r\n        {\r\n            for (let x = 0; x < width; x++)\r\n            {\r\n                let idx = (y * width + x) * 4;\r\n                let p = Matrix3x3.multiplePoint(this.options.viewport.transform, new Vector2(x, y));\r\n                let color = this.raytracer.sample(sdf, p);\r\n                buffer[idx] = color.red;\r\n                buffer[idx + 1] = color.green;\r\n                buffer[idx + 2] = color.blue;\r\n                buffer[idx + 3] = Math.floor(color.alpha * 255);\r\n            }\r\n            /*\r\n            let state = new RenderState();\r\n            state.buffer = new Uint8ClampedArray(buffer);\r\n            state.progress = y / height;\r\n            postMessage(state, undefined, [state.buffer.buffer]);*/\r\n        }\r\n        //outputTarget.width = renderOption.width;\r\n        //outputTarget.height = renderOption.height;\r\n\r\n        /*\r\n        let renderCmd = new RenderCmd(renderOption);\r\n        renderCmd.xRange = new Range(0, renderOption.width);\r\n        renderCmd.yRange = new Range(0, renderOption.height);\r\n\r\n        let imgDta = outputTarget.getContext(\"2d\").getImageData(0, 0, renderOption.width, renderOption.height);\r\n        renderCmd.buffer = new Uint8ClampedArray(imgDta.data);\r\n        startRenderWorker(renderCmd, outputTarget);*/\r\n    }\r\n\r\n    renderSDF(sdf: SDF, buffer: Uint8ClampedArray)\r\n    {\r\n        renderSDF(sdf, this.options, buffer);\r\n    }\r\n}","import { Material, sqrt, min, max, length, abs, clamp, smin, Color } from \"./lib\";\r\nimport { moduleHub } from \"./module-hub\";\r\ntype SDFResult = [number, Material];\r\ntype SDF = (x: number, y: number) => SDFResult;\r\nvar _force_import = [Material, sqrt, min, max, length, abs, clamp, smin, Color, moduleHub];\r\nfunction BuildSDF(sdf: SDF, builder: Function, args: any[]): SDF\r\n{\r\n    (sdf as any).recaller = new FunctionRecaller(builder, args);\r\n    return sdf;\r\n}\r\nclass FunctionRecaller\r\n{\r\n    funcStr: string;\r\n    args: Array<any>;\r\n    isRecaller = true;\r\n    constructor(func: Function, args: any[])\r\n    {\r\n        this.funcStr = func.toString();\r\n        if (/^(function)\\s*([a-zA-Z0-9_$]+)\\s*(\\(.*\\))/.test(this.funcStr))\r\n            this.funcStr = this.funcStr.replace(/^(function)\\s*([a-zA-Z0-9_$]+)\\s*(\\(.*\\))/, \"$1$3\");\r\n        console.log(this.funcStr);\r\n        this.args = args.map(arg => (arg instanceof Function) ? arg.recaller : arg);\r\n    }\r\n    static recall(recaller: FunctionRecaller)\r\n    {\r\n        let args: any[] = recaller.args.map(arg => (arg instanceof FunctionRecaller) ? arg.recall() : arg);\r\n        let func: Function = eval(`(${recaller.funcStr})`);\r\n        return func.call(args);\r\n    }\r\n    recall()\r\n    {\r\n        return FunctionRecaller.recall(this);\r\n    }\r\n}\r\n\r\nexport\r\n{\r\n    FunctionRecaller,\r\n    BuildSDF\r\n};","import { Material, sqrt, min, max, length, abs, clamp } from \"./lib\";\r\nimport { BuildSDF } from \"./sdf-builder\";\r\n/*import { moduleHub } from \"./module-hub\";*/\r\n\r\ntype SDFResult = [number, Material];\r\ntype SDF = (x: number, y: number) => SDFResult;\r\n\r\n/**\r\n * \r\n * @param {Number} r - radius\r\n * @param {Material} material - The material\r\n * @returns {SDF}\r\n */\r\nfunction circle(r: number, material: Material): SDF\r\n{\r\n    //return (x, y) => [sqrt(x * x + y * y) - r, material];\r\n    return BuildSDF(\r\n        (x, y) => [sqrt(x * x + y * y) - r, material],\r\n        circle,\r\n        [r, material]);\r\n}\r\n/**\r\n * \r\n * @param {Number} w - Width of rectangle\r\n * @param {Number} h - Height of rectangle\r\n * @param {Material} material - The material\r\n * @returns {SDF}\r\n */\r\nfunction rect(w:number, h:number, material:Material): SDF\r\n{\r\n    return (x, y) =>\r\n    {\r\n        const dx = Math.abs(x) - w / 2;\r\n        const dy = Math.abs(y) - h / 2;\r\n        return [min(max(dx, dy), 0) + length(max(dx, 0), max(dy, 0)), material];\r\n    };\r\n}\r\n/**\r\n * \r\n * @param {Number} rOuter - Outer radius\r\n * @param {Number} rInner - Inner radius\r\n * @param {Material} material - The material\r\n * @returns {SDF}\r\n */\r\nfunction torus(rOuter:number, rInner:number,material:Material):SDF\r\n{\r\n    const mid = (rOuter + rInner) / 2;\r\n    const wide = (rOuter - rInner) / 2;\r\n    return (x, y) =>\r\n    {\r\n        const l = length(x, y);\r\n        return [abs(l - mid) - wide, material];\r\n    }\r\n}\r\n\r\n/**\r\n * \r\n * @param {Number} wide - Width of the belt\r\n * @param {Material} material - The material\r\n * @returns {SDF}\r\n */\r\nfunction belt(wide: number, material: Material): SDF\r\n{\r\n    return (x, y) => [y - wide / 2, material];\r\n}\r\n\r\n/**\r\n * \r\n * @param {Number} l - Length between two center of semi-circle\r\n * @param {Number} radius - The radius of the semi-circle at end\r\n * @param {Material} material - The material\r\n * @returns {SDF}\r\n */\r\nfunction capsule(l:number, radius:number, material:Material):SDF\r\n{\r\n    const half = l / 2;\r\n    return (x, y) =>\r\n    {\r\n        const dx = abs(x) - half;\r\n        return [length(clamp(dx, 0, abs(dx)), y) - radius, material];\r\n    }\r\n}\r\n\r\nexport { circle, rect, torus, belt, capsule };","import { Color, Vector2, Vector4, plus, scale, vec4, vec2, Range, Material, mapColor, gradient, minus, Rect } from \"./lib\";\r\nimport { RenderOption, SampleFunctions } from \"./render\";\r\n\r\ntype SDFResult = [number, Material];\r\ntype SDF = (x: number, y: number) => SDFResult;\r\ntype SampleFunction = (sdf: SDF, p: Vector2, subdiv: number) => Vector4;\r\n\r\nlet BoundX = new Range(-500, 500);\r\nlet BoundY = new Range(-500, 500);\r\n\r\n\r\nfunction setBound(boundX: Range, boundY: Range)\r\n{\r\n    BoundX = boundX;\r\n    BoundY = boundY;\r\n}\r\n\r\n/*function antiAlias(sdf: SDF, p: Vector2, colorCallback:Function): Vector4\r\n{\r\n    \r\n}*/\r\n\r\nexport class RayTracer2D\r\n{\r\n    options: RenderOption;\r\n    bound: Rect;\r\n\r\n    constructor(options: RenderOption)\r\n    {\r\n        this.options = options;\r\n        this.bound = new Rect(options.viewport.size);\r\n    }\r\n\r\n    trace(sdf: SDF, p: Vector2, dir: Vector2): Vector4\r\n    {\r\n        let distance: number = 0;\r\n        let material: Material;\r\n        dir = dir.normalized;\r\n        do\r\n        {\r\n            p = <Vector2>plus(p, scale(dir, distance));\r\n            [distance, material] = sdf(p.x, p.y);\r\n            if (!this.bound.inRect(p))\r\n                return this.options.environment.backgroundColor.toVector4();\r\n        }\r\n        while (distance > this.options.raytrace.hitThreshold);\r\n        return material.emission.toVector4();\r\n    }\r\n\r\n    sample(sdf: SDF, p: Vector2): Color\r\n    {\r\n        const antiAliasThreshold = 1;\r\n        let sampleFunction: (sdf: SDF, p: Vector2) => Vector4;\r\n        switch (this.options.raytrace.sampleFunction)\r\n        {\r\n            case \"jittered\":\r\n                sampleFunction = this.jitteredSample;\r\n                break;\r\n            case \"stratified\":\r\n                sampleFunction = this.stratifiedSample;\r\n                break;\r\n            case \"uniform\":\r\n                sampleFunction = this.uniformSample;\r\n                break;\r\n        }\r\n        sampleFunction = sampleFunction.bind(this);\r\n        let color = mapColor(sampleFunction(sdf, p), 1 / this.options.raytrace.subDivide);\r\n        let distance = sdf(p.x, p.y)[\"0\"];\r\n        if (0 <= distance && distance <= antiAliasThreshold)\r\n        {\r\n            let grad = new Vector2(gradient(sdf, p.x, p.y, 0.1));\r\n            let pN = <Vector2>minus(p, scale(grad.normalized, antiAliasThreshold));\r\n            let colorN = mapColor(sampleFunction(sdf, pN), 1 / this.options.raytrace.subDivide);\r\n            return Color.blend(colorN, color, distance / antiAliasThreshold);\r\n        }\r\n        return color;\r\n    }\r\n\r\n    \r\n\r\n    uniformSample(sdf: SDF, p: Vector2): Vector4\r\n    {\r\n        let color: Vector4 = vec4(0, 0, 0, 1);\r\n        for (let i = 0; i < this.options.raytrace.subDivide; i++)\r\n        {\r\n            let rad = Math.PI * 2 * Math.random();\r\n            color = <Vector4>plus(this.trace(sdf, p, vec2(Math.cos(rad), Math.sin(rad))), color);\r\n        }\r\n        return color;\r\n    }\r\n\r\n    stratifiedSample(sdf: SDF, p: Vector2): Vector4\r\n    {\r\n        let color: Vector4 = vec4(0, 0, 0, 1);\r\n        for (let i = 0; i < this.options.raytrace.subDivide; i++)\r\n        {\r\n            let rad = Math.PI * 2 * i / this.options.raytrace.subDivide;\r\n            color = <Vector4>plus(this.trace(sdf, p, vec2(Math.cos(rad), Math.sin(rad))), color);\r\n        }\r\n        return color;\r\n    }\r\n    jitteredSample(sdf: SDF, p: Vector2): Vector4\r\n    {\r\n        let color: Vector4 = vec4(0, 0, 0, 1);\r\n        for (let i = 0; i < this.options.raytrace.subDivide; i++)\r\n        {\r\n            let rad = Math.PI * 2 * (i + Math.random()) / this.options.raytrace.subDivide;\r\n            color = <Vector4>plus(this.trace(sdf, p, vec2(Math.cos(rad), Math.sin(rad))), color);\r\n        }\r\n        return color;\r\n    }\r\n\r\n}","import { smin, Color, Material } from \"./lib\";\r\ntype SDFResult = [number, Material];\r\ntype SDF = (x: number, y: number) => SDFResult;\r\n/**\r\n * \r\n * @param {SDF} sdf \r\n * @param {Number} dx \r\n * @param {SDF} dy \r\n * @returns {SDF}\r\n */\r\nfunction translate(sdf:SDF, dx:number, dy:number):SDF\r\n{\r\n    const f: SDF = (x, y) => sdf(x - dx, y - dy);\r\n    f.toString = () =>\r\n    {\r\n        return `\r\n        (x, y) => {\r\n            var sdf = ${sdf.toString()};\r\n            return sdf(x - ${dx}, y - ${dy});\r\n        }`;\r\n    };\r\n    return f;\r\n}\r\n\r\n/**\r\n * \r\n * @param {SDF} sdf \r\n * @param {Number} kx \r\n * @param {Number} [ky] \r\n * @returns {SDF}\r\n */\r\nfunction scale(sdf: SDF, kx: number, ky:number):SDF\r\n{\r\n    kx = kx === undefined ? 1 : kx;\r\n    ky = ky === undefined ? kx : ky;\r\n\r\n    const f: SDF = (x, y) => sdf(x / kx, y / ky);\r\n\r\n    f.toString = () =>\r\n    {\r\n        return `\r\n        (x, y) => {\r\n            var sdf = ${sdf.toString()};\r\n            return sdf(x / ${kx}, y / ${ky});\r\n        }`;\r\n    };\r\n    return f;\r\n}\r\n\r\n/**\r\n * \r\n * @param {SDF} sdf \r\n * @param {Number} rad \r\n * @returns {SDF}\r\n */\r\nfunction rotate(sdf:SDF, rad:number):SDF\r\n{\r\n    const cos = Math.cos(rad);\r\n    const sin = Math.sin(rad);\r\n\r\n    const f: SDF = (x, y) => sdf(x * cos - y * sin, x * sin + y * cos);\r\n\r\n    f.toString = () =>\r\n    {\r\n        return `\r\n        (x, y) => {\r\n            var sdf = ${sdf.toString()};\r\n            return sdf(x * ${cos} - y * ${sin}, x * ${sin} + y * ${cos});\r\n        }`;\r\n    };\r\n    return f;\r\n}\r\n\r\n/**\r\n * \r\n * @param {SDF} sdf1 \r\n * @param {SDF} sdf2 \r\n * @returns {SDF}\r\n */\r\nfunction union(sdf1:SDF, sdf2:SDF):SDF\r\n{\r\n    const f: SDF = (x, y) =>\r\n    {\r\n        let [d1, c1] = sdf1(x, y);\r\n        let [d2, c2] = sdf2(x, y);\r\n        if (d1 < d2)\r\n            return [d1, c1];\r\n        else\r\n            return [d2, c2];\r\n            \r\n    };\r\n\r\n    f.toString = () =>\r\n    {\r\n        return `\r\n        (x, y) =>\r\n        {\r\n            var sdf1 = ${sdf1.toString()};\r\n            var sdf2 = ${sdf2.toString()};\r\n            let [d1, c1] = sdf1(x, y);\r\n            let [d2, c2] = sdf2(x, y);\r\n            if (d1 < d2)\r\n                return [d1, c1];\r\n            else\r\n                return [d2, c2];\r\n\r\n        }`\r\n    };\r\n    return f;\r\n\r\n    \r\n}\r\n\r\n/**\r\n * \r\n * @param {SDF} sdf1 \r\n * @param {SDF} sdf2 \r\n * @returns {SDF}\r\n */\r\nfunction subtract(sdf1:SDF, sdf2:SDF):SDF\r\n{\r\n    return (x, y) =>\r\n    {\r\n        let [d1, c1] = sdf1(x, y);\r\n        let [d2, c2] = sdf2(x, y);\r\n        d2 = -d2;\r\n        if (d1 > d2)\r\n            return [d1, c1];\r\n        else\r\n            return [d2, c1];\r\n\r\n    }\r\n}\r\n\r\n/**\r\n * \r\n * @param {SDF} sdf1 \r\n * @param {SDF} sdf2 \r\n * @returns {SDF}\r\n */\r\nfunction intersect(sdf1:SDF, sdf2:SDF)\r\n{\r\n    return (x: number, y: number) =>\r\n    {\r\n        let [d1, c1] = sdf1(x, y);\r\n        let [d2, c2] = sdf2(x, y);\r\n        if (d1 > d2)\r\n            return [d1, c1];\r\n        else\r\n            return [d2, c2];\r\n\r\n    };\r\n}\r\n\r\n/**\r\n * \r\n * @param {SDF} sdf \r\n * @param {Number} radius \r\n * @returns {SDF}\r\n */\r\nfunction expand(sdf:SDF, radius:number):SDF\r\n{\r\n    return (x, y) =>\r\n    {\r\n        let [d, c] = sdf(x, y);\r\n        return [d - radius, c];\r\n        \r\n    }\r\n}\r\n/*\r\nfunction repeat(sdf:SDF, dx, dy = dx, ox = 0, oy = 0)\r\n{\r\n    return (x, y) => sdf(x % dx + ox, y % dy + oy);\r\n}*/\r\n\r\n/**\r\n * \r\n * @param {SDF} sdf1 \r\n * @param {SDF} sdf2 \r\n * @returns {SDF}\r\n */\r\nfunction displace(sdf1:SDF, sdf2:SDF):SDF\r\n{\r\n    const m = sdf1(0, 0)[\"1\"];\r\n    return (x, y) => [sdf1(x, y)[\"0\"] + sdf2(x, y)[\"0\"], m];\r\n}\r\n\r\n/**\r\n * \r\n * @param {SDF} sdf1 \r\n * @param {SDF} sdf2 \r\n * @param {Number} k \r\n * @returns {SDF}\r\n */\r\nfunction blend(sdf1: SDF, sdf2: SDF, k:number):SDF\r\n{\r\n    const material1 = sdf1(0, 0)[\"1\"];\r\n    const material2 = sdf2(0, 0)[\"1\"];\r\n    const material = new Material();\r\n    material.emission = new Color(\r\n        smin(material1.emission.red, material2.emission.red, k),\r\n        smin(material1.emission.green, material2.emission.green, k),\r\n        smin(material1.emission.blue, material2.emission.blue, k),\r\n        smin(material1.emission.alpha, material2.emission.alpha, k));\r\n\r\n    return (x, y) => [smin(sdf1(x, y)[\"0\"], sdf2(x, y)[\"0\"], k), material];\r\n}\r\n\r\n/**\r\n * \r\n * @param sdf - The SDF function\r\n * @param material - The material to add to this object\r\n */\r\nfunction wrapSDF(sdf: SDF, material: Material): SDF\r\n{\r\n    return (x, y) => [sdf(x, y)[\"0\"], material];\r\n}\r\n\r\nexport { translate, union, scale, rotate, expand, subtract, displace, blend, wrapSDF, intersect };"],"sourceRoot":""}